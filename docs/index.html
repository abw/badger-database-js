<!DOCTYPE html><html><head>
  <meta charset="utf-8">
  <base data-ice="baseUrl">
  <title data-ice="title">Home | Badger Database</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<link rel="stylesheet" href="./inject/css/0-badger.css"><meta name="description" content="Javascript database abstraction layer"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="Badger Database"><meta property="twitter:description" content="Javascript database abstraction layer"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./" style="display: flex; align-items: center;"><img src="./image/brand_logo.svg" style="width:34px;"></a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/abw/badger-database-js"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Connection.js~Connection.html">Connection</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Database.js~Database.html">Database</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Operator.js~Operator.html">Operator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Queries.js~Queries.html">Queries</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Record.js~Record.html">Record</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Schema.js~Schema.html">Schema</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Table.js~Table.html">Table</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Tables.js~Tables.html">Tables</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-connection">connection</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-database">database</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-factory">factory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-queries">queries</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-record">record</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-schema">schema</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-table">table</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Config">Config</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#operator">Operator</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Operator/From.js~From.html">From</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Operator/Select.js~Select.html">Select</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Operator/Where.js~Where.html">Where</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#proxy">Proxy</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-modelProxy">modelProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-recordProxy">recordProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-rowProxy">rowProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-rowsProxy">rowsProxy</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#relation">Relation</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-many">many</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-one">one</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><div data-ice="index" class="github-markdown"><h1 id="badger-database">Badger Database</h1><p>This is a simple but powerful database management tool that
is built around <a href="https://knexjs.org/">Knex.js</a>.  It is
designed for building database abstraction layers that allow
your application code to access a database while keeping the
nitty-gritty detail mostly hidden from view.</p>
<p>It embraces the power of both Knex and raw SQL, but provides
some of the basic functionality of ORMs to help automate many
of the tedious and repetitive tasks associated with using a
relational database.  It uses a variation of the Active Record
pattern - the variation being that the record objects are used
only to represent rows in a database with separate table classes
being employed to represent tables for a better separation of
concerns.</p>
<p>It is a work in progress loosely based on the Perl
<a href="https://github.com/abw/Badger-Database">Badger::Database</a> library.
It is being written to help migrate a number of old Perl projects
to Javascript.</p>
<p>Feel free to use it for your own projects but be warned that
I wrote it to help me get my own job done.  I don't plan to spend
too much time supporting it, updating it, or adding features that
aren't immediately useful to me.</p>
<p>That said, it's a simple project totalling less than a thousand lines
of code.  An experienced Javascript programmer with knowledge of
Knex.js should be able to grok the code in an hour or so.  If you're
happy to use the source, Luke, then it may be the droids you're looking
for.  But if you're looking for a fully-featured, production-ready
solution then it might not be for you - there are <em>plenty</em> of other
Javascript ORMs that might be a better place to start.</p>
<p>For further information please read the <a href="https://abw.github.io/badger-database-js/docs/manual/index.html">manual</a>.</p>
<h2 id="installation">Installation</h2><p>Use your favourite package manager (we'll assume <code>npm</code> in these examples)
to install <code>@abw/badger-database</code>, <code>knex</code> and at least one of the driver modules.</p>
<pre><code class="lang-sh"><code class="source-code prettyprint">    $ npm install @abw/badger-database knex

    # Then add one of the following:
    $ npm install pg
    $ npm install pg-native
    $ npm install sqlite3
    $ npm install better-sqlite3
    $ npm install mysql
    $ npm install mysql2
    $ npm install oracledb
    $ npm install tedious</code></code></pre>
<p>See the <a href="https://knexjs.org/guide/#node-js">Knex.js installation guide</a>
for further information.</p>
<h2 id="quick-start">Quick Start</h2><p>Import the <code>Database</code> module from <code>@abw/badger-database</code>
and create a database.  This example shows a <code>sqlite3</code>
in-memory database which is ideal for testing.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const database = new Database({
  // Knex configuration options
  client: 'sqlite3',
  connection: {
    filename: ':memory:',
  },
  pool: {
    min: 2,
    max: 10,
  },
  useNullAsDefault: true,

  // a simple users tables
  tables: {
    users: {
      columns: 'id name email',
    }
  }
})</code></code></pre>
<p>Use the <a href="https://abw.github.io/badger-database-js/docs/manual/database.html#raw-sql-">raw()</a> method to
run raw SQL queries.  For example, to create the <code>users</code> table:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">await database.raw(
  'CREATE TABLE users ( ' +
  '  id INTEGER PRIMARY KEY ASC, ' +
  '  name TEXT, ' +
  '  email TEXT ' +
  ')'
)</code></code></pre>
<p>Use the
<a href="https://abw.github.io/badger-database-js/docs/manual/database.html#table-name-">table()</a> method to fetch a
<a href="https://abw.github.io/badger-database-js/docs/manual/table.html">Table</a>
object.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const users = database.table('users');</code></code></pre>
<p>Use the
<a href="https://abw.github.io/badger-database-js/docs/manual/table.html#insertrow-data-">insertRow()</a>
method to insert a row.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const bobby = await users.insertRow({
  name: 'Bobby Badger',
  email: 'bobby@badgerpower.com',
})</code></code></pre>
<p>Use the
<a href="https://abw.github.io/badger-database-js/docs/manual/table.html#fetchrow-where-">fetchRow()</a>
method to fetch a single row.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const bobby = await table.fetchRow({
  email: 'bobby@badgerpower.com',
});</code></code></pre>
<p>Append the
<a href="https://abw.github.io/badger-database-js/docs/manual/table.html#record-query-">record()</a>
method to convert the returned row to a
<a href="https://abw.github.io/badger-database-js/docs/manual/record.html">Record</a> object.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const bobby = await table.fetchRow({
  email: 'bobby@badgerpower.com',
}).record();</code></code></pre>
<p>You can then call the <a href="https://abw.github.io/badger-database-js/docs/manual/record.html#update-set-">update()</a> method on the record.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const roberto = await badger.update({
  name: 'Roberto Badger'
});</code></code></pre>
<p>To construct more complex queries you can call the
<a href="https://abw.github.io/badger-database-js/docs/manual/table.html#knex--">knex()</a> method to fetch a Knex
object.  This will have the table name pre-defined. You can then chain
as many Knex methods as you like to construct a query.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const badger =
  await users
    .knex()
    .select('id, name')
    .where({ email: "bobby@badgerpower.com" })
    .first();</code></code></pre>
<p>You can also call the <a href="https://abw.github.io/badger-database-js/docs/manual/database.html#knex--">knex()</a> method on the
database.  In this case you need to specify the table that you're working
on.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const row =
  await database
    .knex('user')
    .select('name')
    .where({ email: 'bobby@badgerpower.com' })
    .first()</code></code></pre>
<h1 id="author">Author</h1><p>Andy Wardley <a href="mailto:abw@wardley.org">abw@wardley.org</a></p>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>


</body></html>