<!DOCTYPE html><html><head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../">
  <title data-ice="title">Manual | Badger Database</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<link rel="stylesheet" href="./inject/css/0-badger.css"><meta name="description" content="Javascript database abstraction layer"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="Badger Database"><meta property="twitter:description" content="Javascript database abstraction layer"></head>
<body class="layout-container manual-root" data-ice="rootContainer">

<header>
  <a href="./" style="display: flex; align-items: center;"><img src="./image/brand_logo.svg" style="width:34px;"></a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/abw/badger-database-js"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div class="manual-toc-root">
  
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/installation.html"><a href="manual/installation.html" data-ice="link">Installation</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/installation.html"><a href="manual/installation.html#npm" data-ice="link">npm</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/installation.html"><a href="manual/installation.html#pnpm" data-ice="link">pnpm</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/installation.html"><a href="manual/installation.html#yarn" data-ice="link">yarn</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/connecting.html"><a href="manual/connecting.html" data-ice="link">Connecting</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/connecting.html"><a href="manual/connecting.html#connection-string" data-ice="link">Connection String</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/connecting.html"><a href="manual/connecting.html#connection-parameters" data-ice="link">Connection Parameters</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/connecting.html"><a href="manual/connecting.html#connection-parameter-aliases" data-ice="link">Connection Parameter Aliases</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/connecting.html"><a href="manual/connecting.html#environment-variables" data-ice="link">Environment Variables</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/connecting.html"><a href="manual/connecting.html#pool-options" data-ice="link">Pool Options</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/connecting.html"><a href="manual/connecting.html#disconnecting" data-ice="link">Disconnecting</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/basic_queries.html"><a href="manual/basic_queries.html" data-ice="link">Basic Queries</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/basic_queries.html"><a href="manual/basic_queries.html#run-query--values--options-" data-ice="link">run(query, values, options)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/basic_queries.html"><a href="manual/basic_queries.html#one-query--values--options-" data-ice="link">one(query, values, options)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/basic_queries.html"><a href="manual/basic_queries.html#any-query--values--options-" data-ice="link">any(query, values, options)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/basic_queries.html"><a href="manual/basic_queries.html#all-query--values--options-" data-ice="link">all(query, values, options)</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/named_queries.html"><a href="manual/named_queries.html" data-ice="link">Named Queries</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/query_fragments.html"><a href="manual/query_fragments.html" data-ice="link">Query Fragments</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/query_builder.html"><a href="manual/query_builder.html" data-ice="link">Query Builder</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/query_builder.html"><a href="manual/query_builder.html#getting-started" data-ice="link">Getting Started</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/query_builder.html"><a href="manual/query_builder.html#selecting-columns-from-tables" data-ice="link">Selecting Columns From Tables</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/query_builder.html"><a href="manual/query_builder.html#embedding-raw-sql" data-ice="link">Embedding Raw SQL</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/query_builder.html"><a href="manual/query_builder.html#placeholder-values" data-ice="link">Placeholder Values</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/query_builder.html"><a href="manual/query_builder.html#running-queries" data-ice="link">Running Queries</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/query_builder.html"><a href="manual/query_builder.html#the-importance-of-being-idempotent" data-ice="link">The Importance of Being Idempotent</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/query_builder.html"><a href="manual/query_builder.html#named-queries-using-a-query-builder" data-ice="link">Named Queries Using a Query Builder</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html" data-ice="link">Query Builder Methods</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#select-columns-" data-ice="link">select(columns)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#from-table-" data-ice="link">from(table)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#where-criteria-" data-ice="link">where(criteria)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#join-table-" data-ice="link">join(table)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#order-columns-" data-ice="link">order(columns)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#group-columns-" data-ice="link">group(columns)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#having-criteria-" data-ice="link">having(criteria)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#limit-n-" data-ice="link">limit(n)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#offset-n-" data-ice="link">offset(n)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#range-from--to-" data-ice="link">range(from, to)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#columns-columns-" data-ice="link">columns(columns)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#table-name-" data-ice="link">table(name)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#prefix-prefix-" data-ice="link">prefix(prefix)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#one-values-" data-ice="link">one(values)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#any-values-" data-ice="link">any(values)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/builder_methods.html"><a href="manual/builder_methods.html#all-values-" data-ice="link">all(values)</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/tables.html"><a href="manual/tables.html" data-ice="link">Tables</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tables.html"><a href="manual/tables.html#insert--update--fetch-and-delete" data-ice="link">Insert, Update, Fetch and Delete</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tables.html"><a href="manual/tables.html#table-queries" data-ice="link">Table Queries</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/table_columns.html"><a href="manual/table_columns.html" data-ice="link">Table Columns</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/table_methods.html"><a href="manual/table_methods.html" data-ice="link">Table Methods</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_methods.html"><a href="manual/table_methods.html#insert-methods" data-ice="link">Insert Methods</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#insert-data--options-" data-ice="link">insert(data, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#insertone-data--options-" data-ice="link">insertOne(data, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#insertall-array--options-" data-ice="link">insertAll(array, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#insertonerecord-data--options-" data-ice="link">insertOneRecord(data, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#insertallrecords-array--options-" data-ice="link">insertAllRecords(array, options)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_methods.html"><a href="manual/table_methods.html#update-methods" data-ice="link">Update Methods</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#update-set--where--options-" data-ice="link">update(set, where, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#updateone-set--where--options-" data-ice="link">updateOne(set, where, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#updateany-set--where--options-" data-ice="link">updateAny(set, where, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#updateall-set--where--options-" data-ice="link">updateAll(set, where, options)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_methods.html"><a href="manual/table_methods.html#delete-method" data-ice="link">Delete Method</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#delete-where-" data-ice="link">delete(where)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_methods.html"><a href="manual/table_methods.html#fetch-methods" data-ice="link">Fetch Methods</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#fetch-where--options-" data-ice="link">fetch(where, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#fetchone-where--options-" data-ice="link">fetchOne(where, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#fetchany-where--options-" data-ice="link">fetchAny(where, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#fetchall-where--options-" data-ice="link">fetchAll(where, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#fetchonerecord-where--options-" data-ice="link">fetchOneRecord(where, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#fetchanyrecord-where--options-" data-ice="link">fetchAnyRecord(where, options)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#fetchallrecords-where--options-" data-ice="link">fetchAllRecords(where, options)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_methods.html"><a href="manual/table_methods.html#record-methods" data-ice="link">Record Methods</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#record-row-" data-ice="link">record(row)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table_methods.html"><a href="manual/table_methods.html#records-rows-" data-ice="link">records(rows)</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/table_queries.html"><a href="manual/table_queries.html" data-ice="link">Table Queries</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#query-methods" data-ice="link">Query Methods</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#named-queries" data-ice="link">Named Queries</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#query-fragments" data-ice="link">Query Fragments</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#query-builder" data-ice="link">Query Builder</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#one-query--values--options-" data-ice="link">one(query, values, options)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#any-query--values--options-" data-ice="link">any(query, values, options)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#all-query--values--options-" data-ice="link">all(query, values, options)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#onerow-query--args-" data-ice="link">oneRow(query, args)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#anyrow-query--args-" data-ice="link">anyRow(query, args)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#allrows-query--args-" data-ice="link">allRows(query, args)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#onerecord-query--args-" data-ice="link">oneRecord(query, args)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#anyrecord-query--args-" data-ice="link">anyRecord(query, args)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#allrecords-query--args-" data-ice="link">allRecords(query, args)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_queries.html"><a href="manual/table_queries.html#run-query--values--options-" data-ice="link">run(query, values, options)</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/table_class.html"><a href="manual/table_class.html" data-ice="link">Table Class</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table_class.html"><a href="manual/table_class.html#table-configuration" data-ice="link">Table Configuration</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/records.html"><a href="manual/records.html" data-ice="link">Records</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/record_methods.html"><a href="manual/record_methods.html" data-ice="link">Record Methods</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/record_methods.html"><a href="manual/record_methods.html#update-set-" data-ice="link">update(set)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/record_methods.html"><a href="manual/record_methods.html#delete--" data-ice="link">delete()</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/record_methods.html"><a href="manual/record_methods.html#relation-name-" data-ice="link">relation(name)</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/record_class.html"><a href="manual/record_class.html" data-ice="link">Record Class</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/record_class.html"><a href="manual/record_class.html#record-configuration-options" data-ice="link">Record Configuration Options</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/relations.html"><a href="manual/relations.html" data-ice="link">Relations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/relations.html"><a href="manual/relations.html#relation-types" data-ice="link">Relation Types</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/relations.html"><a href="manual/relations.html#defining-table-relations" data-ice="link">Defining Table Relations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/relations.html"><a href="manual/relations.html#fetching-relations" data-ice="link">Fetching Relations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/relations.html"><a href="manual/relations.html#additional-constraints" data-ice="link">Additional Constraints</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/relations.html"><a href="manual/relations.html#shorthand-syntax-for-defining-relations" data-ice="link">Shorthand Syntax for Defining Relations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/relations.html"><a href="manual/relations.html#custom-queries" data-ice="link">Custom Queries</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/model.html"><a href="manual/model.html" data-ice="link">Model</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/waiter.html"><a href="manual/waiter.html" data-ice="link">Waiter</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/debugging.html"><a href="manual/debugging.html" data-ice="link">Debugging</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/debugging.html"><a href="manual/debugging.html#sql-parse-errors" data-ice="link">SQL Parse Errors</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/extending.html"><a href="manual/extending.html" data-ice="link">Extending</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/extending.html"><a href="manual/extending.html#custom-tables-class" data-ice="link">Custom Tables Class</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/extending.html"><a href="manual/extending.html#custom-tables-object" data-ice="link">Custom Tables Object</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/extending.html"><a href="manual/extending.html#adding-query-builder-methods" data-ice="link">Adding Query Builder Methods</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/extending.html"><a href="manual/extending.html#adding-a-new-database-engine" data-ice="link">Adding a New Database Engine</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/limitations.html"><a href="manual/limitations.html" data-ice="link">Limitations</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/examples.html"><a href="manual/examples.html" data-ice="link">Examples</a></li>
</ul>
  </div>
</div>
</nav>

<div class="content" data-ice="content"><div class="github-markdown" data-ice="content"><h1 id="table-methods">Table Methods</h1><p>The table object provides a number of methods for generating and running
queries on table rows.</p>
<p>As per the previous examples, we'll assume the table definition looks
something like this:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">// define the users table and the columns it contains
const db = connect({
  database: 'sqlite://test.db',
  tables: {
    users: {
      columns: 'id name:required email:required'
    }
  }
});

// fetch the users table
const users = await db.table('users');</code></code></pre>
<h2 id="insert-methods">Insert Methods</h2><h3 id="insert-data--options-">insert(data, options)</h3><p>The <code>insert()</code> method will construct and run an <code>INSERT</code> SQL query to insert a
row from the column data that you provide.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const result = await users.insert({
  name:  'Brian Badger',
  email: 'brian@badgerpower.com'
});
console.log('Rows changed:', result.changes);
console.log('Generated id:', result.id);</code></code></pre>
<p>The SQL query generated will look like this for Sqlite and Mysql:</p>
<pre><code class="lang-sql"><code class="source-code prettyprint">INSERT INTO users (name, email)
VALUES (?, ?)</code></code></pre>
<p>Note the use of value placeholders <code>?</code> to prevent SQL injection attacks.</p>
<p>The format for placeholders in Postgres is slightly different but has the
exact same effect:</p>
<pre><code class="lang-sql"><code class="source-code prettyprint">INSERT INTO users (name, email)
VALUES ($1, $2)</code></code></pre>
<p>The result returned from the <code>insert()</code> method is an object containing the
number of rows affected as <code>changes</code> and the generated id, where applicable in
<code>id</code>.  If you have defined a different id field (e.g. <code>user_id</code>) then this will
be returned instead.  Other data returned by the database engine may also be
defined.</p>
<p>You can insert multiple rows by passing an array of objects to the method.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const results = await users.insert([
  {
    name:  'Bobby Badger',
    email: 'bobby@badgerpower.com'
  },
  {
    name:  'Brian Badger',
    email: 'brian@badgerpower.com'
  }
]);
console.log('Generated id #1:', results[0].id )
console.log('Generated id #2:', results[1].id )</code></code></pre>
<p>The return value will be an array of results the same as those returned by
calling the method to insert a single row.</p>
<p>In some cases you may want to immediately fetch the inserted row back out of the
database.  This can be the case when you have columns with default values that
will be generated by the database (e.g. a <code>created</code> timestamp) that you want to
inspect.</p>
<p>You could easily do it yourself - the <code>insert()</code> method will return a result containing
the generated <code>id</code> (or other id field) which you can then use to fetch the record.
Or even easier, pass a second argument to the method as an object containing the
<code>reload</code> option set to a true value.</p>
<p>After inserting a row the table <code>insert()</code> method will immediately reload it from the
database and return the data for the row.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const frank = await users.insert(
  {
    name:  'Frank Ferret',
    email: 'frank@ferrets-r-us.com'
  },
  { reload: true }
);
console.log(frank.id);      // e.g. 3
console.log(frank.name);    // Frank Ferret
console.log(frank.email);   // frank@ferrets-r-us.com</code></code></pre>
<p>The same thing happens if you insert multiple rows and specify the <code>reload</code> options.
The only difference is that the return value will be an array of rows.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const animals = await users.insert(
  [
    {
      name:  'Frank Ferret',
      email: 'frank@ferrets-r-us.com'
    },
    {
      name:  'Simon Stoat',
      email: 'simon@stoats-r-superb.com'
    },
  ],
  { reload: true }
);
console.log(animals.length);        // 2
console.log(animals[0].id);         // e.g. 4
console.log(animals[0].name);       // Frank Ferret
console.log(animals[0].email);      // frank@ferrets-r-us.com
console.log(animals[1].id);         // e.g. 5
console.log(animals[1].name);       // Simon Stoat
console.log(animals[1].email);      // simon@stoats-r-superb.com</code></code></pre>
<p>The other option that is supported by the insert methods is <code>record</code>.
This will reload the row from the database (as per the <code>reload</code> option)
and return it as a record object.  We'll be talking more about
<a href="manual/records.html">records</a> shortly but for now you should know that
it exists.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const frank = await users.insert(
  {
    name:  'Frank Ferret',
    email: 'frank@ferrets-r-us.com'
  },
  { record: true }
);
// frank is a record object but it still behaves like a row
console.log(frank.id);      // e.g. 3
console.log(frank.name);    // Frank Ferret
console.log(frank.email);   // frank@ferrets-r-us.com</code></code></pre>
<h3 id="insertone-data--options-">insertOne(data, options)</h3><p>Internally, the <a href="#insert-data--options-">insert()</a> method calls either
<code>insertAll()</code>, if the value passed is an array, or <code>insertOne()</code>
if it's a single data object. You can call these methods directly if you prefer.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const result = await users.insertOne({
  name:  'Brian Badger',
  email: 'brian@badgerpower.com'
});</code></code></pre>
<h3 id="insertall-array--options-">insertAll(array, options)</h3><p>Here's an example explicitly calling the <code>insertAll()</code> method.  It's exactly the
same as calling <a href="#insert-data--options-">insert()</a> with an array of rows to insert.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const results = await users.insertAll([
  {
    name:  'Frank Ferret',
    email: 'frank@badgerpower.com'
  }
  {
    name:  'Simon Stoat',
    email: 'simon@badgerpower.com'
  }
]);</code></code></pre>
<h3 id="insertonerecord-data--options-">insertOneRecord(data, options)</h3><p>This is a wrapper around the <a href="#insertone-data--options-">insertOne()</a> method
which automatically sets the <code>record</code> option for you.  The result returned
will be a record object instead of a result object.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const record = await users.insertOneRecord({
  name:  'Brian Badger',
  email: 'brian@badgerpower.com'
});
// a record object still behaves like a row
console.log(record.name);   // Brian Badger
console.log(record.email);  // brian@badgerpower.com</code></code></pre>
<p>The <code>insertRecord()</code> method is provided as an alias for this method.</p>
<h3 id="insertallrecords-array--options-">insertAllRecords(array, options)</h3><p>This is a wrapper around the <a href="#insertall-array--options-">insertAll()</a> method
which automatically sets the <code>record</code> option for you.  The result returned
will be an array of record objects instead of an array of results.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const records = await users.insertAllRecords([
  {
    name:  'Bobby Badger',
    email: 'bobby@badgerpower.com'
  },
  {
    name:  'Brian Badger',
    email: 'brian@badgerpower.com'
  }
]);
// array of records returned, but they behave like rows
console.log(records.length); // 2
console.log(records[0].name);    // Bobby Badger
console.log(records[0].email);   // bobby@badgerpower.com
console.log(records[1].name);    // Brian Badger
console.log(records[1].email);   // brian@badgerpower.com</code></code></pre>
<p>The <code>insertRecords()</code> method is provided as an alias for this method.</p>
<h2 id="update-methods">Update Methods</h2><h3 id="update-set--where--options-">update(set, where, options)</h3><p>The <code>update()</code> method, as the name suggests, allows you to update rows.
It is an alias for the <a href="#updateall-set--where--options-">updateAll()</a> method.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">await users.update(
  { name: 'Brian "The Brains" Badger' },  // SET...
  { email: 'brian@badgerpower.com' }      // WHERE...
);</code></code></pre>
<p>The first argument is an object containing the changes you want to make.
The second optional argument is the <code>WHERE</code> clause identifying the rows
you want to update.  You can omit the second argument if you want to update
all rows.</p>
<p>The SQL generated for the method call shown above will look something like this:</p>
<pre><code class="lang-sql"><code class="source-code prettyprint">UPDATE users
SET    name=?
WHERE  email=?</code></code></pre>
<p>Again, the format for Postgres is slightly different, using <code>$1</code> and <code>$2</code> for
placeholders instead of <code>?</code>, but works exactly the same.</p>
<p>If you want to use comparison operators (other than the default <code>=</code>) in the
<code>WHERE</code> clause then specify the value as an array of <code>[operator, value]</code>.</p>
<p>For example, to update all rows where the email address isn't <code>brian@badgerpower.com</code>
(I know, I know, this is a terrible example), then you could write:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">await users.update(
  { name: "He's not the Messiah, he's a very naughty boy" },
  { email: ['!=', 'brian@badgerpower.com'] }
);</code></code></pre>
<p>The SQL generated for this example will look something like this:</p>
<pre><code class="lang-sql"><code class="source-code prettyprint">UPDATE users
SET    name=?
WHERE  email!=?</code></code></pre>
<p>Any single value SQL operator can be used, e.g. <code>=</code>, <code>!=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>.
You can't use operators that expect lists of values, e.g. <code>in (...)</code>.</p>
<h3 id="updateone-set--where--options-">updateOne(set, where, options)</h3><p>This is a variant of the <a href="#update-set--where--options-">update()</a> /
<a href="#updateall-set--where--options-">updateAll()</a> method that has an
additional assertion check that exactly one row is updated.  If zero or more
rows are updated then an <code>UnexpectedRowCount</code> error will be thrown with a
message of the form <code>N rows were updated when one was expected</code>.</p>
<p>This method also supports the <code>reload</code> option.  When set, the method will
automatically reload the row from the database after performing the update.
This can be useful if you've got a column which is automatically set when the
record is updated, e.g. a <code>modified</code> column, which you want to inspect.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const row = await users.updateOne(
  { name: 'Brian "The Brains" Badger' },
  { email: 'brian@badgerpower.com' },
  { reload: true }
);
console.log('updated row:', row);</code></code></pre>
<p>The <code>where</code> clause defaults to using the equality operator, <code>=</code>, but as described
in the <a href="#update-set--where--options-">update()</a> method, you can use other comparison
operators by specifying the value as an an array, e.g. <code>{ year: ['&gt;', 2000] }</code>
to match all records where the <code>year</code> is greater than <code>2000</code>.</p>
<p>One thing to note: this uses the modification and selection criteria specified
to reload the data.  If, for example, you change the email address of a row
then it will correctly reload the record using the new email address.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const row = await users.updateOne(
  { email: 'brian-badger@badgerpower.com' },
  { email: 'brian@badgerpower.com' },
  { reload: true }
);
console.log('new email address:', row.email); // brian-badger@badgerpower.com</code></code></pre>
<p>However, there are edge cases where it's not possible to reload the same row that
was modified, based on the criteria provided.  Consider this somewhat contrived
example: if the users table has a <code>friends</code> column and there is exactly one record
where the <code>friends</code> count is set to <code>0</code>.  You feel sorry for the poor user and
decide to modify their <code>friends</code> count to be <code>1</code>.  You'll be their friend, right?</p>
<pre><code class="lang-js"><code class="source-code prettyprint">await users.updateOne(
  { friends: 1 },
  { friends: 0 },
  { reload: true }
);</code></code></pre>
<p>While there may have been exactly one user with <code>friends</code> set to <code>0</code> <em>before</em>
the update, once the update has been applied there may be multiple rows which have
the <code>friends</code> count set to <code>1</code>.  The reload will fail with an <code>UnexpectedRowCount</code>
error.  In these cases you should always provide some other unique attribute to ensure
that the correct row can be identified and reloaded:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">await users.updateOne(
  { friends: 1 },
  { email: 'bobby@badger.com' },
  { reload: true }
);</code></code></pre>
<h3 id="updateany-set--where--options-">updateAny(set, where, options)</h3><p>This is a variant of the <a href="#update-set--where--options-">update()</a> /
<a href="#updateall-set--where--options-">updateAll()</a> method that has an
additional assertion check that no more than one row is updated.  If more
than one rows are updated then an <code>UnexpectedRowCount</code> error will be thrown
with a message of the form <code>N rows were updated when one was expected</code>.</p>
<p>This also supports the <code>reload</code> option.  If a row is updated then the complete
row data will be returned.  Otherwise it will return <code>undefined</code>.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const row = await users.updateAny(
  { name: 'Brian "The Brains" Badger' },
  { email: 'brian@badgerpower.com' },
  { reload: true }
);
if (row) {
  console.log("updated row:", row);
}
else {
  console.log("could not update row - Brian not found!")
}</code></code></pre>
<p>You can also use other comparison operator as per the <a href="#update-set--where--options-">update()</a>
method, e.g. <code>{ year: ['&gt;', 2000] }</code> to match all records where the <code>year</code> is greater
than <code>2000</code>.</p>
<h3 id="updateall-set--where--options-">updateAll(set, where, options)</h3><p>The <a href="#update-set--where--options-">update()</a> method is an alias for the
<code>updateAll()</code> method.  If you want additional checks to be performed to
ensure that you're only updating one row, or if you want to automatically
reload a row after an update then you can use the
<a href="#updateone-set--where--options-">updateOne()</a> or
<a href="#updateany-set--where--options-">updateAny()</a> methods.</p>
<h2 id="delete-method">Delete Method</h2><h3 id="delete-where-">delete(where)</h3><p>You can probably guess what the <code>delete()</code> method does.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">await users.delete({
  email: 'brian@badgerpower.com'
});</code></code></pre>
<p>The object passed as the only argument identifies the rows that you want to delete.</p>
<p>The SQL generated will look something like this:</p>
<pre><code class="lang-sql"><code class="source-code prettyprint">DELETE FROM users
WHERE email=?</code></code></pre>
<p>You can omit the selection criteria if you want to delete all rows in the table.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">await users.delete()</code></code></pre>
<p>Naturally, you should use this method with caution.</p>
<p>You can also use other comparison operator in the <code>where</code> clause, as per the
<a href="#update-set--where--options-">update()</a> method, e.g. <code>{ year: ['&gt;', 2000] }</code>
to match all records where the <code>year</code> is greater than <code>2000</code>.</p>
<h2 id="fetch-methods">Fetch Methods</h2><h3 id="fetch-where--options-">fetch(where, options)</h3><p>This is an alias for the <a href="#fetchall-where--options-">fetchAll()</a> method.</p>
<h3 id="fetchone-where--options-">fetchOne(where, options)</h3><p>There are three different methods for fetching rows from the table using
selection criteria.  The <code>fetchOne()</code> method will return a single row.
If the row isn't found or multiple rows match the criteria then an
<code>UnexpectedRowCount</code> error will be thrown with a message of
the form <code>N rows were returned when one was expected</code>.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">// returns a single row or throws an error
const brian = await users.fetchOne({
  email: 'brian@badgerpower.com'
});
console.log('Brian:', brian);</code></code></pre>
<p>The <code>where</code> clause default to using the equality operator, <code>=</code>, but like the
<a href="#update-set--where--options-">update()</a> and <a href="#delete-where-">delete()</a> methods,
you can use other comparison operators, e.g. <code>{ year: ['&gt;', 2000] }</code> to match
all records where the <code>year</code> is greater than <code>2000</code>.</p>
<p>You can pass a second argument which can contain various options to modify
the selection.  For example, the <code>columns</code> option can be used to specify
the columns that you want to select.  They can be specified as a string
containing the columns names separated by whitespace:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const brian = await users.fetchOne(
  { email: 'brian@badgerpower.com' },
  { columns: 'id name' }
);</code></code></pre>
<p>Or as an array:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const brian = await users.fetchOne(
  { email: 'brian@badgerpower.com' },
  { columns: ['id', 'name'] }
);</code></code></pre>
<p>The <code>record</code> option can be specified if you want the data returned as a
<a href="manual/record.html">record</a> instead of a row.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const brian = await users.fetchOne(
  { email: 'brian@badgerpower.com' },
  { record: true }
);</code></code></pre>
<p>The generated SQL for this method (and also <a href="#fetchany-where--options-">fetchAny()</a>
and <a href="#fetchall-where--options-">fetchAll()</a> will look something like this:</p>
<pre><code class="lang-sql"><code class="source-code prettyprint">SELECT "users"."id", "users"."name" FROM users
WHERE email=?</code></code></pre>
<h3 id="fetchany-where--options-">fetchAny(where, options)</h3><p>The <code>fetchAny()</code> method will return a single row if it exists or <code>undefined</code> if it doesn't.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">// returns a single row or undefined
const brian = await users.fetchAny({
  email: 'brian@badgerpower.com'
});
if (brian) {
  console.log('Brian:', brian);
}
else {
  console.log('Brian Badger was not found');
}</code></code></pre>
<p>The <code>where</code> clause default to using the equality operator, <code>=</code>, but like numerous
other methods described above, you can use other comparison operators e.g.
<code>{ year: ['&gt;', 2000] }</code> to match all records where the <code>year</code> is greater
than <code>2000</code>.</p>
<p>As per <a href="#fetchone-where--options-">fetchOne()</a> you can pass an additional object
containing options.  For example, to specify the columns you want returned:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const brian = await users.fetchAny(
  { email: 'brian@badgerpower.com' },
  { columns: 'id email' }
);</code></code></pre>
<p>Or to return the row as a record object:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const brian = await users.fetchAny(
  { email: 'brian@badgerpower.com' },
  { record: true }
);</code></code></pre>
<h3 id="fetchall-where--options-">fetchAll(where, options)</h3><p>The <code>fetchAll()</code> method will return an array of all matching rows.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">// returns an array of all rows (possibly empty)
const bobbies = await users.fetchAll(
  { name: 'Bobby Badger' }
);
if (bobbies.length) {
  console.log("Fetched %s users called 'Bobby Badger':", bobbies.length);
}
else {
  console.log("There aren't any users called 'Bobby Badger'");
}</code></code></pre>
<p>If you want to return all matching rows then you can omit the criteria or
specify an empty object.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const allUsers = await users.fetchAll();</code></code></pre>
<pre><code class="lang-js"><code class="source-code prettyprint">const allUsers = await users.fetchAll({ });</code></code></pre>
<p>It shouldn't surprise you to learn that you can use other comparison operators
in the <code>where</code> clause, e.g. <code>{ year: ['&gt;', 2000] }</code> to match all records where
the <code>year</code> is greater than <code>2000</code>.</p>
<p>As per <a href="#fetchone-where--options-">fetchOne()</a> you can pass an additional objects
containing options.  It supports the <code>columns</code> and <code>record</code> options.  You can
also provide <code>order</code> (or <code>orderBy</code> if you prefer to use a naming convention as
close as possible to the SQL equivalent of <code>ORDER BY</code>) to specify the order in
which rows should be returned:</p>
<p>The <code>order</code> can contain multiple columns and each will be automatically quoted.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const allUsers = await users.fetchAll(
  { },  // you can specify selection criteria or use an empty object to fetch all rows
  { order: 'name, id' }   // -&gt; ORDER BY "name", "id"
);</code></code></pre>
<p>If you want to use a raw SQL order then define it as an object with a single <code>sql</code>
property:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const allUsers = await users.fetchAll(
  { },  // you can specify selection criteria or use an empty object to fetch all rows
  { order: { sql: 'name DESC' } }
);</code></code></pre>
<p>Or use the <code>sql</code> function to generate it for you from a tagged template literal.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">import { sql } from '@abw/badger-database'

const allUsers = await users.fetchAll(
  { },  // you can specify selection criteria or use an empty object to fetch all rows
  { order: sql`name DESC` }
);</code></code></pre>
<h3 id="fetchonerecord-where--options-">fetchOneRecord(where, options)</h3><p>This method is a wrapper around <a href="#fetchone-where--options-">fetchOne()</a> which returns
the row as a record object.  It effectively sets the <code>record</code> option for you.</p>
<p>Read more about records <a href="manual/records.html">here</a>.</p>
<p>The <code>fetchRecord()</code> method is provided as an alias for this method.</p>
<h3 id="fetchanyrecord-where--options-">fetchAnyRecord(where, options)</h3><p>This method is a wrapper around <a href="#fetchany-where--options-">fetchAny()</a> which returns
the row as a record object.</p>
<h3 id="fetchallrecords-where--options-">fetchAllRecords(where, options)</h3><p>This method is a wrapper around <a href="#fetchall-where--options-">fetchAll()</a> which returns
the rows as an array of record objects.</p>
<p>The <code>fetchRecords()</code> method is provided as an alias for this method.</p>
<h2 id="record-methods">Record Methods</h2><h3 id="record-row-">record(row)</h3><p>This methods converts a row of data to a <a href="manual/records.html">record</a> object.</p>
<h3 id="records-rows-">records(rows)</h3><p>This methods converts an array of rows of data to a an array of <a href="manual/records.html">record</a> objects.</p>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>


</body></html>