<!DOCTYPE html><html><head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../">
  <title data-ice="title">Manual | Badger Database</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<link rel="stylesheet" href="./inject/css/0-badger.css"><meta name="description" content="Javascript database abstraction layer"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="Badger Database"><meta property="twitter:description" content="Javascript database abstraction layer"></head>
<body class="layout-container manual-root" data-ice="rootContainer">

<header>
  <a href="./" style="display: flex; align-items: center;"><img src="./image/brand_logo.svg" style="width:34px;"></a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/abw/badger-database-js"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div class="manual-toc-root">
  
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/getting_started.html"><a href="manual/getting_started.html" data-ice="link">Getting Started</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/getting_started.html"><a href="manual/getting_started.html#installation" data-ice="link">Installation</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/getting_started.html"><a href="manual/getting_started.html#npm" data-ice="link">npm</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/getting_started.html"><a href="manual/getting_started.html#pnpm" data-ice="link">pnpm</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/getting_started.html"><a href="manual/getting_started.html#yarn" data-ice="link">yarn</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/getting_started.html"><a href="manual/getting_started.html#basic-use" data-ice="link">Basic Use</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/overview.html"><a href="manual/overview.html" data-ice="link">Overview</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/database.html"><a href="manual/database.html" data-ice="link">Database</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/database.html"><a href="manual/database.html#overview" data-ice="link">Overview</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/database.html"><a href="manual/database.html#configuration" data-ice="link">Configuration</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#knex-configuration-options" data-ice="link">Knex Configuration Options</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#queries" data-ice="link">queries</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#fragments" data-ice="link">fragments</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#tables" data-ice="link">tables</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#tablesclass" data-ice="link">tablesClass</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#tablesobject" data-ice="link">tablesObject</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/database.html"><a href="manual/database.html#properties" data-ice="link">Properties</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#connection" data-ice="link">connection</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#model" data-ice="link">model</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#queries" data-ice="link">queries</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/database.html"><a href="manual/database.html#methods" data-ice="link">Methods</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#knex--" data-ice="link">knex()</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#raw-sql-" data-ice="link">raw(sql)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#query-name-" data-ice="link">query(name)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#hastable-name-" data-ice="link">hasTable(name)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#table-name-" data-ice="link">table(name)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#escape-name-" data-ice="link">escape(name)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#destroy--" data-ice="link">destroy()</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/database.html"><a href="manual/database.html#functions" data-ice="link">Functions</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/database.html"><a href="manual/database.html#database--" data-ice="link">database()</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/table.html"><a href="manual/table.html" data-ice="link">Table</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table.html"><a href="manual/table.html#overview" data-ice="link">Overview</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table.html"><a href="manual/table.html#configuration" data-ice="link">Configuration</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#table" data-ice="link">table</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#columns" data-ice="link">columns</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/table.html"><a href="manual/table.html#column-metadata" data-ice="link">column metadata</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#virtualcolumns" data-ice="link">virtualColumns</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#columnsets" data-ice="link">columnSets</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#undefined" data-ice="link">id</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#keys" data-ice="link">keys</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#queries" data-ice="link">queries</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#fragments" data-ice="link">fragments</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#tableclass" data-ice="link">tableClass</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#recordclass" data-ice="link">recordClass</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table.html"><a href="manual/table.html#methods" data-ice="link">Methods</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#knex--" data-ice="link">knex()</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#raw--" data-ice="link">raw()</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#query-name-" data-ice="link">query(name)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#insert-data-" data-ice="link">insert(data)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#insertrow-data-" data-ice="link">insertRow(data)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#insertrows-data-" data-ice="link">insertRows(data)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#selectall-columns-" data-ice="link">selectAll(columns)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#selectone-columns-" data-ice="link">selectOne(columns)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#fetchall-where-" data-ice="link">fetchAll(where)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#fetchone-where-" data-ice="link">fetchOne(where)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#update-set-where-" data-ice="link">update(set,where)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#record-query-" data-ice="link">record(query)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#records-query-" data-ice="link">records(query)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/table.html"><a href="manual/table.html#functions" data-ice="link">Functions</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/table.html"><a href="manual/table.html#table-database-schema-" data-ice="link">table(database,schema)</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/record.html"><a href="manual/record.html" data-ice="link">Record</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/record.html"><a href="manual/record.html#overview" data-ice="link">Overview</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/record.html"><a href="manual/record.html#methods" data-ice="link">Methods</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/record.html"><a href="manual/record.html#update-set-" data-ice="link">update(set)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/record.html"><a href="manual/record.html#functions" data-ice="link">Functions</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/record.html"><a href="manual/record.html#record-table-data-options-" data-ice="link">record(table,data,options)</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/model.html"><a href="manual/model.html" data-ice="link">Model</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/model.html"><a href="manual/model.html#overview" data-ice="link">Overview</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/queries.html"><a href="manual/queries.html" data-ice="link">Queries</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/queries.html"><a href="manual/queries.html#overview" data-ice="link">Overview</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/queries.html"><a href="manual/queries.html#configuration" data-ice="link">Configuration</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/queries.html"><a href="manual/queries.html#queries" data-ice="link">queries</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/queries.html"><a href="manual/queries.html#fragments" data-ice="link">fragments</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/queries.html"><a href="manual/queries.html#methods" data-ice="link">Methods</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/queries.html"><a href="manual/queries.html#query-name-" data-ice="link">query(name)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/queries.html"><a href="manual/queries.html#expandfragments-query-" data-ice="link">expandFragments(query)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/queries.html"><a href="manual/queries.html#functions" data-ice="link">Functions</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/queries.html"><a href="manual/queries.html#queries-schema-" data-ice="link">queries(schema)</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/connection.html"><a href="manual/connection.html" data-ice="link">Connection</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/connection.html"><a href="manual/connection.html#configuration" data-ice="link">Configuration</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/connection.html"><a href="manual/connection.html#properties" data-ice="link">Properties</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/connection.html"><a href="manual/connection.html#config" data-ice="link">config</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/connection.html"><a href="manual/connection.html#knex" data-ice="link">knex</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/connection.html"><a href="manual/connection.html#methods" data-ice="link">Methods</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/connection.html"><a href="manual/connection.html#raw-sql-" data-ice="link">raw(sql)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/connection.html"><a href="manual/connection.html#pool--" data-ice="link">pool()</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/connection.html"><a href="manual/connection.html#acquire--" data-ice="link">acquire()</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/connection.html"><a href="manual/connection.html#destroy--" data-ice="link">destroy()</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/connection.html"><a href="manual/connection.html#functions" data-ice="link">Functions</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/connection.html"><a href="manual/connection.html#connection--" data-ice="link">connection()</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/schema.html"><a href="manual/schema.html" data-ice="link">Schema</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/schema.html"><a href="manual/schema.html#configuration" data-ice="link">Configuration</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#table" data-ice="link">table</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#columns" data-ice="link">columns</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#virtualcolumns" data-ice="link">virtualColumns</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#columnsets" data-ice="link">columnSets</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#undefined" data-ice="link">id</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#keys" data-ice="link">keys</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#relations" data-ice="link">relations</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#queries" data-ice="link">queries</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#fragments" data-ice="link">fragments</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#tableclass" data-ice="link">tableClass</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#recordclass" data-ice="link">recordClass</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/schema.html"><a href="manual/schema.html#properties" data-ice="link">Properties</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#database" data-ice="link">database</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#table" data-ice="link">table</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#undefined" data-ice="link">id</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#keys" data-ice="link">keys</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#keyindex" data-ice="link">keyIndex</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#columnindex" data-ice="link">columnIndex</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#columnnames" data-ice="link">columnNames</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#virtualcolumns" data-ice="link">virtualColumns</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#allcolumns" data-ice="link">allColumns</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#columnsets" data-ice="link">columnSets</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#relations" data-ice="link">relations</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#fragments" data-ice="link">fragments</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/schema.html"><a href="manual/schema.html#methods" data-ice="link">Methods</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#preparecolumns-schema-" data-ice="link">prepareColumns(schema)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#preparecolumnsets-schema-" data-ice="link">prepareColumnSets(schema)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#preparekeys-schema-" data-ice="link">prepareKeys(schema)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#preparefragments-schema-" data-ice="link">prepareFragments(schema)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#column-name-" data-ice="link">column(name)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#columnset-name-" data-ice="link">columnSet(name)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#defaultcolumns--" data-ice="link">defaultColumns()</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#columns-names-" data-ice="link">columns(names)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#resolvecolumns-names-" data-ice="link">resolveColumns(names)</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#identity-data-" data-ice="link">identity(data)</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/schema.html"><a href="manual/schema.html#functions" data-ice="link">Functions</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/schema.html"><a href="manual/schema.html#schema-database-tableschema-" data-ice="link">schema(database,tableSchema)</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/tables.html"><a href="manual/tables.html" data-ice="link">Tables</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tables.html"><a href="manual/tables.html#overview" data-ice="link">Overview</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tables.html"><a href="manual/tables.html#configuration" data-ice="link">Configuration</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tables.html"><a href="manual/tables.html#tables" data-ice="link">tables</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tables.html"><a href="manual/tables.html#methods" data-ice="link">Methods</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tables.html"><a href="manual/tables.html#table-name-" data-ice="link">table(name)</a></li>
</ul>
  </div>
</div>
</nav>

<div class="content" data-ice="content"><div class="github-markdown" data-ice="content"><h1 id="table">Table</h1><p>This is a wrapper around a database table.</p>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#configuration">Configuration</a><ul>
<li><a href="#table">table</a></li>
<li><a href="#columns">columns</a></li>
<li><a href="#virtualcolumns">virtualColumns</a></li>
<li><a href="#columnsets">columnSets</a></li>
<li><a href="#id">id</a></li>
<li><a href="#keys">keys</a></li>
<li><a href="#queries">queries</a></li>
<li><a href="#fragments">fragments</a></li>
<li><a href="#tableclass">tableClass</a></li>
<li><a href="#recordclass">recordClass</a></li>
</ul>
</li>
<li><a href="#methods">Methods</a><ul>
<li><a href="#knex--">knex()</a></li>
<li><a href="#raw--">raw()</a></li>
<li><a href="#query-name-">query(name)</a></li>
<li><a href="#insert-data-">insert(data)</a></li>
<li><a href="#insertrow-data-">insertRow(data)</a></li>
<li><a href="#insertrows-data-">insertRows(data)</a></li>
<li><a href="#selectall-columns-">selectAll(columns)</a></li>
<li><a href="#selectone-columns-">selectOne(columns)</a></li>
<li><a href="#fetchall-where-">fetchAll(where)</a></li>
<li><a href="#fetchone-where-">fetchOne(where)</a></li>
<li><a href="#update-set-where-">update(set,where)</a></li>
<li><a href="#record-query-">record(query)</a></li>
<li><a href="#records-query-">records(query)</a></li>
</ul>
</li>
<li><a href="#functions">Functions</a><ul>
<li><a href="#table-database-schema-">table(database,schema)</a></li>
</ul>
</li>
</ul>
<h2 id="overview">Overview</h2><p>Conceptually we think of a table as being a collection of records.  I prefer to use
plural names (e.g. <code>users</code> and <code>companies</code> instead of <code>user</code> and <code>company</code>) in
keeping with that paradigm, but you can use any names you like.</p>
<p>The names of the tables you define for your application don't have to match the names
of the underlying database table.</p>
<h2 id="configuration">Configuration</h2><p>Tables are defined via the <code>tables</code> item in a database configuration.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">import Database from '@abw/badger-database'

const database = new Database(
  // ...client, connection, pool, etc...
  tables: {
    users: {
      // ... schema for users table
    },
    companies: {
      // ... schema for companies table
    }
  }
)</code></code></pre>
<p>You can then access a table object using the <code>table()</code> method.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const users = database.table('users');</code></code></pre>
<p>The configuration items for a table are as follows.</p>
<h3 id="table">table</h3><p>The default behaviour is to assume that the name of the underlying database table
is the same as the collection name.  If it isn't then you can use the <code>table</code>
configuration option to define it.</p>
<p>For example, if you want to define a collection of <code>users</code> in your application but the
underlying table name is <code>user</code> then you can define it like so:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const database = new Database(
  // ...client, connection, pool, etc...
  tables: {
    users: {
      table: 'user'
    },
  }
)</code></code></pre>
<h3 id="columns">columns</h3><p>The <code>columns</code> configuration item is used to define the columns that you want the
collection to have access to.  You don't have to include all of the columns in the
database table if you don't want to.</p>
<p>In the simplest case you can define the columns as a string of whitespace delimited
names.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const database = new Database(
  // ...client, connection, pool, etc...
  tables: {
    users: {
      columns: 'id name email'
    },
  }
)</code></code></pre>
<p>This is shorthand for specifying them as an array, which you can do if you prefer
or already have the column names in an array.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const database = new Database(
  // ...client, connection, pool, etc...
  tables: {
    users: {
      columns: ['id', 'name', 'email']
    },
  }
)</code></code></pre>
<p>The third option is to use a hash object to define the columns.  This allows you to
provide additional metadata about the columns.  You can add any metadata you like.
At the time of writing the metadata isn't used internally, but it might be soon.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const database = new Database(
  // ...client, connection, pool, etc...
  tables: {
    users: {
      columns: {
        id: {
          type: 'id',
          automatic: true,
        },
        name: {
          type: 'text',
          required: true,
        },
        email: {
          type: 'text',
          required: true,
        }
      }
    },
  }
)</code></code></pre>
<h4 id="column-metadata">column metadata</h4><p>TODO: add information about column metadata as and when we start to use it.</p>
<h3 id="virtualcolumns">virtualColumns</h3><p>Any computed columns can be specified as <code>virtualColumns</code>.  For example, if you
have a user table with separate <code>forename</code> and <code>surname</code> columns then you might
want to add a virtual column that concatenates them to create a <code>name</code>.</p>
<p>In MySQL the <code>CONCAT()</code> function can be used.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const database = new Database(
  // ...client, connection, pool, etc...
  tables: {
    users: {
      columns: 'id forename surname email',
      virtualColumns: {
        name: "CONCAT(users.forename, ' ', users.surname)"
      }
    },
  }
)</code></code></pre>
<p>In sqlite the <code>||</code> operator is used for concatenation so the <code>name</code>
virtual column would be defined like this:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">virtualColumns: {
  name: "users.forename || ' ' || users.surname"
}</code></code></pre>
<p>Note that it is considered good practice to specify the table and column
name in these cases, e.g. <code>users.forename</code> instead of just <code>forename</code>.
This will save any ambiguity when you're constructing queries that might
join onto other tables.  You might also want to escape the table and/or
column names if either are reserved words.</p>
<p>For example, MySQL uses the backtick character to escape names.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">virtualColumns: {
  name: "CONCAT(`users`.`forename`, ' ', `users`.`surname`)"
}</code></code></pre>
<h3 id="columnsets">columnSets</h3><p>You can define set of columns that provide a shorthand way of referencing
commonly used subsets of columns.  By default, queries will use all of the
<code>columns</code> defined.  Any <code>virtualColumns</code> will not be included.</p>
<p>You can define a <code>default</code> column set to indicate which columns should be
included in queries by default.  For example, in our <code>users</code> table we might
want to exclude the <code>password</code> and <code>is_admin</code> columns, but include the <code>name</code>
virtual column.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">users = {
  columns: 'id forename surname email password is_admin',
  virtualColumns: {
    name: "CONCAT(users.forename, ' ', users.surname)"
  },
  columnSets: {
    default: 'id forename surname name email',
  }
};</code></code></pre>
<p>The columns in a column set can be specified as a string of whitespace delimited column
names as shown above.  This is shorthand for an array of column names:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">columnSets: {
  default: ['id', 'forename', 'surname', 'name', 'email'],
}</code></code></pre>
<p>The more explicit form is to define an object containing <code>include</code> and/or <code>exclude</code>
columns.  These operations are performed on the list of <code>columns</code>, so <code>include</code> can be
used to add in virtual columns or <code>exclude</code> can be used to exclude regular columns
that you don't want returned by default.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">columnSets: {
  default: {
    include: 'name',
    exclude: 'password is_admin'
  },
}</code></code></pre>
<p>You can define any of your own named column sets in the same way.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">columnSets: {
  // id forename surname email name
  default: {
    include: 'name',
    exclude: 'password is_admin'
  },
  // id forename surname email password is_admin name
  admin: {
    include: 'name',
  },
  // name email
  basic: 'name email',
};</code></code></pre>
<h3>id</h3><p>The <code>id</code> configuration item can be used to name the column that is the
unique identifier for a row.  If you don't specify either <code>id</code> or <code>keys</code>
then it will default to <code>id</code>.</p>
<p>For example, if the <code>users</code> table uses the <code>user_id</code> column as the unique
identifier then you should specify it like so:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">users: {
  columns: 'user_id forename surname email',
  id: 'user_id'
}</code></code></pre>
<h3 id="keys">keys</h3><p>In some cases you might have a table with a compound key composed from multiple
columns instead of a single <code>id</code> column.  For example, an <code>employees</code> table might
have a compound key formed from the <code>user_id</code> and <code>company_id</code> columns.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">employees: {
  columns: 'user_id company_id job_title start_date end_date',
  keys: 'user_id company_id'
}</code></code></pre>
<h3 id="queries">queries</h3><p>Used to define named SQL queries that you can then run by calling the
<a href="#query-name-">query(name)</a> method specifying the name of the query.</p>
<p>See the <a href="manual/database.html#queries">database queries option</a> for examples
and the <a href="manual/queries.html">Queries</a> manual page for further information.</p>
<h3 id="fragments">fragments</h3><p>Use to define commonly used SQL fragments that can be interpolated into
named <a href="#queries">queries</a>.</p>
<p>In additional to any user-supplied <a href="#fragments">fragments</a>, a number of
additional fragments specific to the table will also be defined.  These
will all be pre-escaped according to the database client in use.  For
example, when using sqlite3, a table column of <code>albums.id</code> will be escaped
as <code>"albums"."id"</code> whereas for MySQL it will be escaped with backticks
instead of double quote characters.</p>
<ul>
<li><code>table</code> - the table name, e.g. <code>"albums"</code></li>
<li><code>columns</code> - a comma separated list of all table column names,
e.g. <code>"id", "title", "year"</code></li>
<li><code>tcolumns</code> - a comma separated list of all column names prefixed with
the table name, e.g. <code>"albums"."id", "albums"."title", "albums"."year"</code></li>
</ul>
<p>In additional any <a href="#virtualcolumns">virtualColumns</a> are included in the
fragments.  For example, consider a <a href="#virtualcolumns">virtualColumn</a> defined
like this:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">virtualColumns: {
  titleYear:    'title || " (" || year || ")"',
}</code></code></pre>
<p>It can be embedded in SQL queries as <code>&lt;titleYear&gt;</code> and will expand
to <code>title || " (" || year || ")" as titleYear</code>.</p>
<p>Note that you are responsible for escaping any table names or columns that
might be reserved words in your <a href="#virtualcolumns">virtualColumns</a> and
<a href="#fragments">fragments</a>.</p>
<p>See the <a href="manual/database.html#queries">database fragments option</a> for examples
and the <a href="manual/queries.html">Queries</a> manual page for further information.</p>
<h3 id="tableclass">tableClass</h3><p>You can create your own subclass of the <code>Table</code> module and define your own
methods for queries on the table.</p>
<p>Here's a simple <code>Users</code> class which implements a <code>badgers()</code> method to
fetch all rows where the surname is <code>Badger</code>.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">export class Users extends Table {
  badgers() {
    return this.fetchAll({ surname: "Badger" });
  }
}</code></code></pre>
<p>Then in the schema for the <code>users</code> class, define the <code>Users</code> class as the
<code>tableClass</code> configuration item.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const database = new Database(
  // ...client, connection, pool, etc...
  tables: {
    users: {
      tableClass: Users
    },
  }
)</code></code></pre>
<p>Now you can call the <code>badgers()</code> method on the table object for the <code>users</code> table.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const badgers = await database.table('users').badgers()</code></code></pre>
<h3 id="recordclass">recordClass</h3><p>Various table methods have the option to convert rows returned from the database into
record objects.  This provides a simple implementation of the Active Record pattern.</p>
<p>The default <a href="manual/record.html">Record</a> class provides basic functionality to update
the record, delete it, access related records, and so on.</p>
<p>You can also define your own record subclass for a table in which you can provide
additional methods or wrap the default methods to implement additional business logic,
data validation, logging, etc.  In this case you should use the <code>recordClass</code> configuration
option to provide a reference to your custom record class.</p>
<p>This simple example shows how a custom <code>User</code> record class can be defined which adds a
<code>hello()</code> method.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">import { Database, Record } from  "@abw/badger-database";

// define User subclass of Record
class User extends Record {
  hello() {
    return `Hello ${this.forename} ${this.surname}`;
  }
}

// create database connection with users table
const database = new Database(
  // ...client, connection, pool, etc...
  tables: {
    users: {
      columns: 'id forename surname',
      recordClass: User,
    },
  }
)

// insert row and convert returned data to a User record
const bobby = await database.table('users').insert({
  forename: 'Bobby',
  surname: 'Badger',
}).record()

console.log(bobby.hello())    // Hello Bobby Badger</code></code></pre>
<h2 id="methods">Methods</h2><h3 id="knex--">knex()</h3><p>Returns a Knex query with the table name pre-defined.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const badger =
  await users
    .knex()
    .select('forename')
    .where({ email: "bobby@badger.com" })
    .first();</code></code></pre>
<h3 id="raw--">raw()</h3><p>Used to generate a raw SQL query for the database.  Equivalent to calling
<code>knex.raw()</code>.</p>
<h3 id="query-name-">query(name)</h3><p>This method allows you to execute a named query that was previously
defined using the <a href="#queries">queries</a> configuration option.</p>
<p>Given this database definition:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const database = new Database(
  // ...client, connection, pool, etc...
  tables: {
    albums: {
      columns: 'id title'
      queries: {
        albumsByNumberOfTracks:
          'SELECT albums.title, COUNT(tracks.id) as n_tracks ' +
          'FROM albums ' +
          'JOIN tracks ' +
          'ON tracks.album_id=albums.id ' +
          'GROUP BY albums.id ' +
          'ORDER BY n_tracks ',
      }
    },
    tracks: {
      columns: 'id title album_id'
    }
  }
)</code></code></pre>
<p>You can then run the <code>albumsByNumberOfTracks</code> query like so:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const albums = await database
  .table('albums')
  .query('albumsByNumberOfTracks');</code></code></pre>
<p>You can embed <a href="#fragments">fragments</a> in your queries inside angle brackets.</p>
<p>If the <code>name</code> passed to the <code>query()</code> method is a single word then it is
assumed to be a pre-defined named query (and an error will be throw if it
doesn't exist).  Otherwise it is assumed to be a raw SQL query.  The query
can also include embedded fragments, including those that are auto-generated
such as <code>table</code> for the table name and <code>columns</code> for the table columns.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const albums = await database
  .table('albums')
  .query('SELECT &lt;columns&gt; FROM &lt;table&gt; ORDER BY year,id');</code></code></pre>
<h3 id="insert-data-">insert(data)</h3><p>Insert data into the table.  You can pass a single object row or an array of
rows to insert.  This method will then delegate to <a href="#insertrow-data-">insertRow()</a>
or <a href="#insertrows-data-">insertRows()</a> as appropriate</p>
<p>Single row:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const bobby = await users.insert({
  forename: 'Bobby',
  surname: 'Badger',
  email: 'bobby@badger.com',
  is_admin: 1,
})</code></code></pre>
<p>Multiple rows:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const badgers = await users.insert([
  {
    forename: 'Bobby',
    surname: 'Badger',
    email: 'bobby@badger.com',
    is_admin: 1,
  },
  {
    forename: 'Brian',
    surname: 'Badger',
    email: 'brian@badger.com',
    is_admin: 0,
  },
  {
    forename: 'Simon',
    surname: 'Stoat',
    email: 'simon@stoat.com',
  }
]);</code></code></pre>
<h3 id="insertrow-data-">insertRow(data)</h3><p>This inserts a single row into the database and then fetches the row back
out again.  Note that this is different to the <a href="https://knexjs.org/guide/query-builder.html#insert">insert() method</a>
provided by Knex.js which only returns the ID of the inserted record.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const bobby = await users.insertRow({
  forename: 'Bobby',
  surname: 'Badger',
  email: 'bobby@badger.com',
  is_admin: 1,
})</code></code></pre>
<p>One benefit of this approach is in situations where you want to insert a row and then do
something with the inserted data, e.g. return it via an API response.  By fetching the
record after it has been inserted we guarantee that any automatically created column
values are included.  For example, this would include any generated ID value, and also
any columns that have default values, e.g. a <code>created</code> column that defaults to have the
current timestamp.</p>
<p>Another feature is that the value returned from the <code>insertRow()</code> method is a proxy which
intercepts the <code>record()</code> method call and converts the raw row data to a record object.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const bobby = await users.insertRow({
  forename: 'Bobby',
  surname: 'Badger',
  email: 'bobby@badger.com',
  is_admin: 1,
}).record()   // convert to record object</code></code></pre>
<p>The downside is that you're performing two database queries (an insert and a select) instead
of one.  If you don't want or need this functionality then you can use the underlying
Knex.js <code>insert()</code> method instead.</p>
<h3 id="insertrows-data-">insertRows(data)</h3><p>This inserts multiple row into the database and then fetches the rows back
out again, as per <a href="#insertrow-data-">insertRow()</a>.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const badgers = await users.insertRows([
  {
    forename: 'Bobby',
    surname: 'Badger',
    email: 'bobby@badger.com',
    is_admin: 1,
  },
  {
    forename: 'Brian',
    surname: 'Badger',
    email: 'brian@badger.com',
    is_admin: 0,
  },
  {
    forename: 'Simon',
    surname: 'Stoat',
    email: 'simon@stoat.com',
  }
]);</code></code></pre>
<p>The method returns an array of inerted row.  You can call the <code>records()</code> method to
convert them to <a href="manual/record.html">Record</a> objects.</p>
<h3 id="selectall-columns-">selectAll(columns)</h3><p>Returns a select query.  The optional <code>columns</code> argument can be used to
specify the <a href="#columns">columns</a> or <a href="#columnsets">columnSets</a> you want to select.
Otherwise the default column set will be used.</p>
<p>To include the columns named in a column set, include the name of the column
set prefixed by <code>...</code>, e.g. <code>...admin</code> to include the columns defined in the
<code>admin</code> column set.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const rows = await table.selectAll();
const rows = await table.selectAll("name email ...admin");</code></code></pre>
<p>The method returns a proxy around the Knex query.  You can call additional Knex
methods on it.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const rows = await table.selectAll().where({ animal: "badger" });</code></code></pre>
<p>You can also call the <code>records()</code> method to convert the data rows to
<a href="manual/record.html">Record</a> objects.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const records = await table.selectAll().where({ animal: "badger" }).records();</code></code></pre>
<h3 id="selectone-columns-">selectOne(columns)</h3><p>Returns a select query to fetch a single row.  The optional <code>columns</code> argument
can be used to specify the columns or column sets you want to select.  Otherwise
the default column set will be used.</p>
<p>As with <a href="#selectall-columns-">selectAll()</a> you can call additional Knex methods
on the returned query object.  You can also call the <code>record()</code> method to convert
the row data to a <a href="manual/record.html">Record</a> object.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const row = await table.selectOne();
const row = await table.selectOne("column1 column2 ...columnset");
const row = await table.selectOne().where({ email: "bobby@badger.com" });
const rec = await table.selectOne().where({ email: "bobby@badger.com" }).record();</code></code></pre>
<h3 id="fetchall-where-">fetchAll(where)</h3><p>Returns a select query with the default columns selected.  The optional
<code>where</code> argument can be used to provide additional constraints.  This is
shorthand for chaining a <code>where()</code> method.</p>
<p>You can also chain the <code>records()</code> method to convert the data rows to
<a href="manual/record.html">Record</a> objects.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const rows = await table.fetchAll();
const rows = await table.fetchAll({ animal: "badger" });
const recs = await table.fetchAll({ animal: "badger" }).records();</code></code></pre>
<h3 id="fetchone-where-">fetchOne(where)</h3><p>Returns a select query that fetches a single record with the default columns
selected.  The optional <code>where</code> argument can be used to provide additional
constraints.  This is shorthand for chaining a <code>where()</code> method.</p>
<p>You can also chain the <code>record()</code> method to convert the data row to a
<a href="manual/record.html">Record</a> object.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const row = await table.fetchOne();
const row = await table.fetchOne({ animal: "badger" });
const rec = await table.fetchOne({ animal: "badger" }).record();</code></code></pre>
<h3 id="update-set-where-">update(set,where)</h3><p>This method can be used to update one or more rows in the database.
The first argument is an object defining updates to be set in the rows.
The second argument is an object providing the criteria to match rows.</p>
<p>For example, this call will set the <code>is_admin</code> column to <code>1</code> for all rows
where the <code>surname</code> is <code>Badger</code>.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">await users.update({ is_admin: 1 }, { surname: 'Badger' });</code></code></pre>
<p>The <code>update()</code> method works like the <a href="#insertrows-data-">insertRows()</a> method
in that it will perform two queries: the first to apply the changes and the second
to re-fetch all the matching rows from the database.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const badgers = await users.update({ is_admin: 1 }, { surname: 'Badger' });</code></code></pre>
<p>This ensures that the data returned will include any columns that are updated
by the database.  For example, you might have a <code>modified</code> column which is
automatically updated when the record is modified.  In MySQL that column
would be defined something like this:</p>
<pre><code class="lang-sql"><code class="source-code prettyprint">modified TIMESTAMP NOT NULL
         DEFAULT CURRENT_TIMESTAMP
         ON UPDATE CURRENT_TIMESTAMP</code></code></pre>
<p>When you call the <code>update()</code> method the rows will contain the <code>modified</code> data
items reflecting the new values set in the database table rows.</p>
<p>The rows that are returned by the <code>update()</code> method can be converted to records
by chaining the <code>records()</code> method.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const badgers = await users.update({ is_admin: 1 }, { surname: 'Badger' }).records();</code></code></pre>
<p>If you don't want this behaviour and just want to update the rows without re-fetching
them, then you can "roll your own" update using the Knex query returned by the
<a href="#knex--">knex()</a> method.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">await users.knex().update({ is_admin: 1 }).where({ surname: 'Badger' });</code></code></pre>
<h3 id="record-query-">record(query)</h3><p>Method to create a record object from a single row returned by a query.
This is called automagically by appending a <code>.record()</code> method to the
end of a query returned by <code>selectOne()</code> or <code>fetchOne()</code>.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const badger = await table.fetchOne({ animal: "badger" }).record();</code></code></pre>
<h3 id="records-query-">records(query)</h3><p>Method to create record objects from all rows returned by a query.
This is called automagically by appending a <code>.records()</code> method to the
end of a query returned by <code>selectAll()</code>, <code>fetchAll()</code> or <code>update()</code>.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">const badgers = await table.fetchAll({ animal: "badger" }).records();</code></code></pre>
<h2 id="functions">Functions</h2><h3 id="table-database-schema-">table(database,schema)</h3><p>A function of convenience which wraps a call to <code>new Table()</code>.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">import { table } from '@abw/badger-database';
const tab = table(...);</code></code></pre>
<p>This is equivalent to:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">import { Table } from '@abw/badger-database';
const tab = new Table(...);</code></code></pre>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>


</body></html>