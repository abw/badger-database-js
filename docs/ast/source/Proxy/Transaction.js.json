{
  "type": "File",
  "start": 0,
  "end": 4450,
  "loc": {
    "start": {
      "line": 1,
      "column": 0,
      "index": 0
    },
    "end": {
      "line": 105,
      "column": 0,
      "index": 4450
    }
  },
  "errors": [],
  "program": {
    "type": "Program",
    "start": 0,
    "end": 4450,
    "loc": {
      "start": {
        "line": 1,
        "column": 0,
        "index": 0
      },
      "end": {
        "line": 105,
        "column": 0,
        "index": 4450
      }
    },
    "sourceType": "module",
    "interpreter": null,
    "body": [
      {
        "type": "ImportDeclaration",
        "start": 2712,
        "end": 2760,
        "loc": {
          "start": {
            "line": 52,
            "column": 0,
            "index": 2712
          },
          "end": {
            "line": 52,
            "column": 48,
            "index": 2760
          }
        },
        "specifiers": [
          {
            "type": "ImportSpecifier",
            "start": 2721,
            "end": 2736,
            "loc": {
              "start": {
                "line": 52,
                "column": 9,
                "index": 2721
              },
              "end": {
                "line": 52,
                "column": 24,
                "index": 2736
              }
            },
            "imported": {
              "type": "Identifier",
              "start": 2721,
              "end": 2736,
              "loc": {
                "start": {
                  "line": 52,
                  "column": 9,
                  "index": 2721
                },
                "end": {
                  "line": 52,
                  "column": 24,
                  "index": 2736
                },
                "identifierName": "databaseBuilder"
              },
              "name": "databaseBuilder"
            },
            "local": {
              "type": "Identifier",
              "start": 2721,
              "end": 2736,
              "loc": {
                "start": {
                  "line": 52,
                  "column": 9,
                  "index": 2721
                },
                "end": {
                  "line": 52,
                  "column": 24,
                  "index": 2736
                },
                "identifierName": "databaseBuilder"
              },
              "name": "databaseBuilder"
            }
          }
        ],
        "source": {
          "type": "StringLiteral",
          "start": 2744,
          "end": 2760,
          "loc": {
            "start": {
              "line": 52,
              "column": 32,
              "index": 2744
            },
            "end": {
              "line": 52,
              "column": 48,
              "index": 2760
            }
          },
          "extra": {
            "rawValue": "../Builders.js",
            "raw": "\"../Builders.js\""
          },
          "value": "../Builders.js"
        },
        "trailingComments": [
          {
            "type": "CommentLine",
            "value": " import { yellow } from \"../Utils/Color.js\";",
            "start": 2761,
            "end": 2807,
            "loc": {
              "start": {
                "line": 53,
                "column": 0,
                "index": 2761
              },
              "end": {
                "line": 53,
                "column": 46,
                "index": 2807
              }
            }
          }
        ],
        "leadingComments": [
          {
            "type": "CommentBlock",
            "value": "\n  This is a proxy around the database for processing transactions.\n  It's an elegant hack, or an ugly hack, depending on how you look at\n  it.  But either way, it's a hack.\n\n  All requests in a transaction must be run using the same database\n  connection.  This is a problem because we use a connection pool.\n  When a query is run the engine takes a connection from the pool,\n  runs the query and then releases the connection back to the pool.\n  This proxy exists to convince the engine to do something different.\n\n  The database transaction() method creates a Transaction object and\n  then calls its run() method.  The run() method acquires a database\n  connection from the pool and then calls the user code provided to\n  it.  It passes this proxy wrapper around the database along with\n  commit and rollback handlers.  When the run() method is complete\n  the connection is released back to the pool.\n\n  The other part of the puzzle is making sure that the database engine\n  uses the transaction's database connection instead of acquiring a new\n  one. All queries are created as Query objects via the database\n  buildQuery() method.  The proxy catches calls to that method and adds\n  the transaction reference to the configuration options. The Query\n  module then forwards the transaction reference to the engine.execute()\n  method which will then use the transaction's connection instead of\n  acquiring one from the connection pool.\n\n  We also need to catch any calls to the table() method and add in the\n  nocache option.  This ensures that a NEW table object is created with\n  a database reference that is the proxy wrapper for the database rather\n  than the database itself.  This ensures that any database queries that\n  are run by the table object inside a transaction are also run the\n  same way using the transaction's connection.  Table objects are cached\n  so if we didn't do this then there's the chance we'd get a cached table\n  which had a reference to the unwrapped database.\n\n  We also need to intercept any access to database.build which contains\n  a \"root node\" for using the query builder.  The select(), insert(),\n  update() and delete() methods all use this, and end users can also use\n  it to construct new queries.  Instead of returning the cached\n  database.build (which contains a reference to the database), we create\n  a new builder object which contains a reference to the database proxy\n  wrapper.\n\n  (DONE), model and waiter.\n  TODO: I've got a nasty suspicion that we could have problems with named\n  queries or fragments that are built using the query builder as they\n  are all rooted on a Builder/Database node that contains the database\n  reference.  Need to check this.\n",
            "start": 0,
            "end": 2710,
            "loc": {
              "start": {
                "line": 1,
                "column": 0,
                "index": 0
              },
              "end": {
                "line": 50,
                "column": 2,
                "index": 2710
              }
            }
          }
        ]
      },
      {
        "type": "VariableDeclaration",
        "start": 2809,
        "end": 4080,
        "loc": {
          "start": {
            "line": 55,
            "column": 0,
            "index": 2809
          },
          "end": {
            "line": 87,
            "column": 1,
            "index": 4080
          }
        },
        "declarations": [
          {
            "type": "VariableDeclarator",
            "start": 2815,
            "end": 4080,
            "loc": {
              "start": {
                "line": 55,
                "column": 6,
                "index": 2815
              },
              "end": {
                "line": 87,
                "column": 1,
                "index": 4080
              }
            },
            "id": {
              "type": "Identifier",
              "start": 2815,
              "end": 2823,
              "loc": {
                "start": {
                  "line": 55,
                  "column": 6,
                  "index": 2815
                },
                "end": {
                  "line": 55,
                  "column": 14,
                  "index": 2823
                },
                "identifierName": "handlers"
              },
              "name": "handlers"
            },
            "init": {
              "type": "ObjectExpression",
              "start": 2826,
              "end": 4080,
              "loc": {
                "start": {
                  "line": 55,
                  "column": 17,
                  "index": 2826
                },
                "end": {
                  "line": 87,
                  "column": 1,
                  "index": 4080
                }
              },
              "properties": [
                {
                  "type": "ObjectProperty",
                  "start": 2952,
                  "end": 3167,
                  "loc": {
                    "start": {
                      "line": 58,
                      "column": 2,
                      "index": 2952
                    },
                    "end": {
                      "line": 61,
                      "column": 3,
                      "index": 3167
                    }
                  },
                  "method": false,
                  "key": {
                    "type": "Identifier",
                    "start": 2952,
                    "end": 2962,
                    "loc": {
                      "start": {
                        "line": 58,
                        "column": 2,
                        "index": 2952
                      },
                      "end": {
                        "line": 58,
                        "column": 12,
                        "index": 2962
                      },
                      "identifierName": "buildQuery"
                    },
                    "name": "buildQuery"
                  },
                  "computed": false,
                  "shorthand": false,
                  "value": {
                    "type": "ArrowFunctionExpression",
                    "start": 2964,
                    "end": 3167,
                    "loc": {
                      "start": {
                        "line": 58,
                        "column": 14,
                        "index": 2964
                      },
                      "end": {
                        "line": 61,
                        "column": 3,
                        "index": 3167
                      }
                    },
                    "id": null,
                    "generator": false,
                    "async": false,
                    "params": [
                      {
                        "type": "Identifier",
                        "start": 2965,
                        "end": 2966,
                        "loc": {
                          "start": {
                            "line": 58,
                            "column": 15,
                            "index": 2965
                          },
                          "end": {
                            "line": 58,
                            "column": 16,
                            "index": 2966
                          },
                          "identifierName": "_"
                        },
                        "name": "_"
                      },
                      {
                        "type": "Identifier",
                        "start": 2968,
                        "end": 2974,
                        "loc": {
                          "start": {
                            "line": 58,
                            "column": 18,
                            "index": 2968
                          },
                          "end": {
                            "line": 58,
                            "column": 24,
                            "index": 2974
                          },
                          "identifierName": "method"
                        },
                        "name": "method"
                      },
                      {
                        "type": "Identifier",
                        "start": 2976,
                        "end": 2987,
                        "loc": {
                          "start": {
                            "line": 58,
                            "column": 26,
                            "index": 2976
                          },
                          "end": {
                            "line": 58,
                            "column": 37,
                            "index": 2987
                          },
                          "identifierName": "transaction"
                        },
                        "name": "transaction"
                      }
                    ],
                    "body": {
                      "type": "FunctionExpression",
                      "start": 2992,
                      "end": 3167,
                      "loc": {
                        "start": {
                          "line": 58,
                          "column": 42,
                          "index": 2992
                        },
                        "end": {
                          "line": 61,
                          "column": 3,
                          "index": 3167
                        }
                      },
                      "id": null,
                      "generator": false,
                      "async": false,
                      "params": [
                        {
                          "type": "Identifier",
                          "start": 3002,
                          "end": 3008,
                          "loc": {
                            "start": {
                              "line": 58,
                              "column": 52,
                              "index": 3002
                            },
                            "end": {
                              "line": 58,
                              "column": 58,
                              "index": 3008
                            },
                            "identifierName": "source"
                          },
                          "name": "source"
                        },
                        {
                          "type": "AssignmentPattern",
                          "start": 3010,
                          "end": 3019,
                          "loc": {
                            "start": {
                              "line": 58,
                              "column": 60,
                              "index": 3010
                            },
                            "end": {
                              "line": 58,
                              "column": 69,
                              "index": 3019
                            }
                          },
                          "left": {
                            "type": "Identifier",
                            "start": 3010,
                            "end": 3016,
                            "loc": {
                              "start": {
                                "line": 58,
                                "column": 60,
                                "index": 3010
                              },
                              "end": {
                                "line": 58,
                                "column": 66,
                                "index": 3016
                              },
                              "identifierName": "config"
                            },
                            "name": "config"
                          },
                          "right": {
                            "type": "ObjectExpression",
                            "start": 3017,
                            "end": 3019,
                            "loc": {
                              "start": {
                                "line": 58,
                                "column": 67,
                                "index": 3017
                              },
                              "end": {
                                "line": 58,
                                "column": 69,
                                "index": 3019
                              }
                            },
                            "properties": []
                          }
                        }
                      ],
                      "body": {
                        "type": "BlockStatement",
                        "start": 3021,
                        "end": 3167,
                        "loc": {
                          "start": {
                            "line": 58,
                            "column": 71,
                            "index": 3021
                          },
                          "end": {
                            "line": 61,
                            "column": 3,
                            "index": 3167
                          }
                        },
                        "body": [
                          {
                            "type": "ReturnStatement",
                            "start": 3100,
                            "end": 3163,
                            "loc": {
                              "start": {
                                "line": 60,
                                "column": 4,
                                "index": 3100
                              },
                              "end": {
                                "line": 60,
                                "column": 67,
                                "index": 3163
                              }
                            },
                            "argument": {
                              "type": "CallExpression",
                              "start": 3107,
                              "end": 3163,
                              "loc": {
                                "start": {
                                  "line": 60,
                                  "column": 11,
                                  "index": 3107
                                },
                                "end": {
                                  "line": 60,
                                  "column": 67,
                                  "index": 3163
                                }
                              },
                              "callee": {
                                "type": "MemberExpression",
                                "start": 3107,
                                "end": 3119,
                                "loc": {
                                  "start": {
                                    "line": 60,
                                    "column": 11,
                                    "index": 3107
                                  },
                                  "end": {
                                    "line": 60,
                                    "column": 23,
                                    "index": 3119
                                  }
                                },
                                "object": {
                                  "type": "Identifier",
                                  "start": 3107,
                                  "end": 3113,
                                  "loc": {
                                    "start": {
                                      "line": 60,
                                      "column": 11,
                                      "index": 3107
                                    },
                                    "end": {
                                      "line": 60,
                                      "column": 17,
                                      "index": 3113
                                    },
                                    "identifierName": "method"
                                  },
                                  "name": "method"
                                },
                                "computed": false,
                                "property": {
                                  "type": "Identifier",
                                  "start": 3114,
                                  "end": 3119,
                                  "loc": {
                                    "start": {
                                      "line": 60,
                                      "column": 18,
                                      "index": 3114
                                    },
                                    "end": {
                                      "line": 60,
                                      "column": 23,
                                      "index": 3119
                                    },
                                    "identifierName": "apply"
                                  },
                                  "name": "apply"
                                }
                              },
                              "arguments": [
                                {
                                  "type": "ThisExpression",
                                  "start": 3120,
                                  "end": 3124,
                                  "loc": {
                                    "start": {
                                      "line": 60,
                                      "column": 24,
                                      "index": 3120
                                    },
                                    "end": {
                                      "line": 60,
                                      "column": 28,
                                      "index": 3124
                                    }
                                  }
                                },
                                {
                                  "type": "ArrayExpression",
                                  "start": 3126,
                                  "end": 3162,
                                  "loc": {
                                    "start": {
                                      "line": 60,
                                      "column": 30,
                                      "index": 3126
                                    },
                                    "end": {
                                      "line": 60,
                                      "column": 66,
                                      "index": 3162
                                    }
                                  },
                                  "elements": [
                                    {
                                      "type": "Identifier",
                                      "start": 3127,
                                      "end": 3133,
                                      "loc": {
                                        "start": {
                                          "line": 60,
                                          "column": 31,
                                          "index": 3127
                                        },
                                        "end": {
                                          "line": 60,
                                          "column": 37,
                                          "index": 3133
                                        },
                                        "identifierName": "source"
                                      },
                                      "name": "source"
                                    },
                                    {
                                      "type": "ObjectExpression",
                                      "start": 3135,
                                      "end": 3161,
                                      "loc": {
                                        "start": {
                                          "line": 60,
                                          "column": 39,
                                          "index": 3135
                                        },
                                        "end": {
                                          "line": 60,
                                          "column": 65,
                                          "index": 3161
                                        }
                                      },
                                      "properties": [
                                        {
                                          "type": "SpreadElement",
                                          "start": 3137,
                                          "end": 3146,
                                          "loc": {
                                            "start": {
                                              "line": 60,
                                              "column": 41,
                                              "index": 3137
                                            },
                                            "end": {
                                              "line": 60,
                                              "column": 50,
                                              "index": 3146
                                            }
                                          },
                                          "argument": {
                                            "type": "Identifier",
                                            "start": 3140,
                                            "end": 3146,
                                            "loc": {
                                              "start": {
                                                "line": 60,
                                                "column": 44,
                                                "index": 3140
                                              },
                                              "end": {
                                                "line": 60,
                                                "column": 50,
                                                "index": 3146
                                              },
                                              "identifierName": "config"
                                            },
                                            "name": "config"
                                          }
                                        },
                                        {
                                          "type": "ObjectProperty",
                                          "start": 3148,
                                          "end": 3159,
                                          "loc": {
                                            "start": {
                                              "line": 60,
                                              "column": 52,
                                              "index": 3148
                                            },
                                            "end": {
                                              "line": 60,
                                              "column": 63,
                                              "index": 3159
                                            }
                                          },
                                          "method": false,
                                          "key": {
                                            "type": "Identifier",
                                            "start": 3148,
                                            "end": 3159,
                                            "loc": {
                                              "start": {
                                                "line": 60,
                                                "column": 52,
                                                "index": 3148
                                              },
                                              "end": {
                                                "line": 60,
                                                "column": 63,
                                                "index": 3159
                                              },
                                              "identifierName": "transaction"
                                            },
                                            "name": "transaction"
                                          },
                                          "computed": false,
                                          "shorthand": true,
                                          "value": {
                                            "type": "Identifier",
                                            "start": 3148,
                                            "end": 3159,
                                            "loc": {
                                              "start": {
                                                "line": 60,
                                                "column": 52,
                                                "index": 3148
                                              },
                                              "end": {
                                                "line": 60,
                                                "column": 63,
                                                "index": 3159
                                              },
                                              "identifierName": "transaction"
                                            },
                                            "name": "transaction"
                                          },
                                          "extra": {
                                            "shorthand": true
                                          }
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            "leadingComments": [
                              {
                                "type": "CommentLine",
                                "value": " console.log(yellow('adding transaction to buildQuery() config'));",
                                "start": 3027,
                                "end": 3095,
                                "loc": {
                                  "start": {
                                    "line": 59,
                                    "column": 4,
                                    "index": 3027
                                  },
                                  "end": {
                                    "line": 59,
                                    "column": 72,
                                    "index": 3095
                                  }
                                }
                              }
                            ]
                          }
                        ],
                        "directives": []
                      }
                    }
                  },
                  "leadingComments": [
                    {
                      "type": "CommentLine",
                      "value": " When the database buildQuery() method is called we add the",
                      "start": 2830,
                      "end": 2891,
                      "loc": {
                        "start": {
                          "line": 56,
                          "column": 2,
                          "index": 2830
                        },
                        "end": {
                          "line": 56,
                          "column": 63,
                          "index": 2891
                        }
                      }
                    },
                    {
                      "type": "CommentLine",
                      "value": " transaction reference into the configuration options",
                      "start": 2894,
                      "end": 2949,
                      "loc": {
                        "start": {
                          "line": 57,
                          "column": 2,
                          "index": 2894
                        },
                        "end": {
                          "line": 57,
                          "column": 57,
                          "index": 2949
                        }
                      }
                    }
                  ]
                },
                {
                  "type": "ObjectProperty",
                  "start": 3357,
                  "end": 3572,
                  "loc": {
                    "start": {
                      "line": 66,
                      "column": 2,
                      "index": 3357
                    },
                    "end": {
                      "line": 69,
                      "column": 3,
                      "index": 3572
                    }
                  },
                  "method": false,
                  "key": {
                    "type": "Identifier",
                    "start": 3357,
                    "end": 3362,
                    "loc": {
                      "start": {
                        "line": 66,
                        "column": 2,
                        "index": 3357
                      },
                      "end": {
                        "line": 66,
                        "column": 7,
                        "index": 3362
                      },
                      "identifierName": "table"
                    },
                    "name": "table"
                  },
                  "computed": false,
                  "shorthand": false,
                  "value": {
                    "type": "ArrowFunctionExpression",
                    "start": 3364,
                    "end": 3572,
                    "loc": {
                      "start": {
                        "line": 66,
                        "column": 9,
                        "index": 3364
                      },
                      "end": {
                        "line": 69,
                        "column": 3,
                        "index": 3572
                      }
                    },
                    "id": null,
                    "generator": false,
                    "async": false,
                    "params": [
                      {
                        "type": "Identifier",
                        "start": 3365,
                        "end": 3366,
                        "loc": {
                          "start": {
                            "line": 66,
                            "column": 10,
                            "index": 3365
                          },
                          "end": {
                            "line": 66,
                            "column": 11,
                            "index": 3366
                          },
                          "identifierName": "_"
                        },
                        "name": "_"
                      },
                      {
                        "type": "Identifier",
                        "start": 3368,
                        "end": 3374,
                        "loc": {
                          "start": {
                            "line": 66,
                            "column": 13,
                            "index": 3368
                          },
                          "end": {
                            "line": 66,
                            "column": 19,
                            "index": 3374
                          },
                          "identifierName": "method"
                        },
                        "name": "method"
                      },
                      {
                        "type": "Identifier",
                        "start": 3376,
                        "end": 3387,
                        "loc": {
                          "start": {
                            "line": 66,
                            "column": 21,
                            "index": 3376
                          },
                          "end": {
                            "line": 66,
                            "column": 32,
                            "index": 3387
                          },
                          "identifierName": "transaction"
                        },
                        "name": "transaction"
                      }
                    ],
                    "body": {
                      "type": "FunctionExpression",
                      "start": 3392,
                      "end": 3572,
                      "loc": {
                        "start": {
                          "line": 66,
                          "column": 37,
                          "index": 3392
                        },
                        "end": {
                          "line": 69,
                          "column": 3,
                          "index": 3572
                        }
                      },
                      "id": null,
                      "generator": false,
                      "async": false,
                      "params": [
                        {
                          "type": "Identifier",
                          "start": 3402,
                          "end": 3406,
                          "loc": {
                            "start": {
                              "line": 66,
                              "column": 47,
                              "index": 3402
                            },
                            "end": {
                              "line": 66,
                              "column": 51,
                              "index": 3406
                            },
                            "identifierName": "name"
                          },
                          "name": "name"
                        },
                        {
                          "type": "AssignmentPattern",
                          "start": 3408,
                          "end": 3418,
                          "loc": {
                            "start": {
                              "line": 66,
                              "column": 53,
                              "index": 3408
                            },
                            "end": {
                              "line": 66,
                              "column": 63,
                              "index": 3418
                            }
                          },
                          "left": {
                            "type": "Identifier",
                            "start": 3408,
                            "end": 3415,
                            "loc": {
                              "start": {
                                "line": 66,
                                "column": 53,
                                "index": 3408
                              },
                              "end": {
                                "line": 66,
                                "column": 60,
                                "index": 3415
                              },
                              "identifierName": "options"
                            },
                            "name": "options"
                          },
                          "right": {
                            "type": "ObjectExpression",
                            "start": 3416,
                            "end": 3418,
                            "loc": {
                              "start": {
                                "line": 66,
                                "column": 61,
                                "index": 3416
                              },
                              "end": {
                                "line": 66,
                                "column": 63,
                                "index": 3418
                              }
                            },
                            "properties": []
                          }
                        }
                      ],
                      "body": {
                        "type": "BlockStatement",
                        "start": 3420,
                        "end": 3572,
                        "loc": {
                          "start": {
                            "line": 66,
                            "column": 65,
                            "index": 3420
                          },
                          "end": {
                            "line": 69,
                            "column": 3,
                            "index": 3572
                          }
                        },
                        "body": [
                          {
                            "type": "ReturnStatement",
                            "start": 3491,
                            "end": 3568,
                            "loc": {
                              "start": {
                                "line": 68,
                                "column": 4,
                                "index": 3491
                              },
                              "end": {
                                "line": 68,
                                "column": 81,
                                "index": 3568
                              }
                            },
                            "argument": {
                              "type": "CallExpression",
                              "start": 3498,
                              "end": 3568,
                              "loc": {
                                "start": {
                                  "line": 68,
                                  "column": 11,
                                  "index": 3498
                                },
                                "end": {
                                  "line": 68,
                                  "column": 81,
                                  "index": 3568
                                }
                              },
                              "callee": {
                                "type": "MemberExpression",
                                "start": 3498,
                                "end": 3510,
                                "loc": {
                                  "start": {
                                    "line": 68,
                                    "column": 11,
                                    "index": 3498
                                  },
                                  "end": {
                                    "line": 68,
                                    "column": 23,
                                    "index": 3510
                                  }
                                },
                                "object": {
                                  "type": "Identifier",
                                  "start": 3498,
                                  "end": 3504,
                                  "loc": {
                                    "start": {
                                      "line": 68,
                                      "column": 11,
                                      "index": 3498
                                    },
                                    "end": {
                                      "line": 68,
                                      "column": 17,
                                      "index": 3504
                                    },
                                    "identifierName": "method"
                                  },
                                  "name": "method"
                                },
                                "computed": false,
                                "property": {
                                  "type": "Identifier",
                                  "start": 3505,
                                  "end": 3510,
                                  "loc": {
                                    "start": {
                                      "line": 68,
                                      "column": 18,
                                      "index": 3505
                                    },
                                    "end": {
                                      "line": 68,
                                      "column": 23,
                                      "index": 3510
                                    },
                                    "identifierName": "apply"
                                  },
                                  "name": "apply"
                                }
                              },
                              "arguments": [
                                {
                                  "type": "ThisExpression",
                                  "start": 3511,
                                  "end": 3515,
                                  "loc": {
                                    "start": {
                                      "line": 68,
                                      "column": 24,
                                      "index": 3511
                                    },
                                    "end": {
                                      "line": 68,
                                      "column": 28,
                                      "index": 3515
                                    }
                                  }
                                },
                                {
                                  "type": "ArrayExpression",
                                  "start": 3517,
                                  "end": 3567,
                                  "loc": {
                                    "start": {
                                      "line": 68,
                                      "column": 30,
                                      "index": 3517
                                    },
                                    "end": {
                                      "line": 68,
                                      "column": 80,
                                      "index": 3567
                                    }
                                  },
                                  "elements": [
                                    {
                                      "type": "Identifier",
                                      "start": 3518,
                                      "end": 3522,
                                      "loc": {
                                        "start": {
                                          "line": 68,
                                          "column": 31,
                                          "index": 3518
                                        },
                                        "end": {
                                          "line": 68,
                                          "column": 35,
                                          "index": 3522
                                        },
                                        "identifierName": "name"
                                      },
                                      "name": "name"
                                    },
                                    {
                                      "type": "ObjectExpression",
                                      "start": 3524,
                                      "end": 3566,
                                      "loc": {
                                        "start": {
                                          "line": 68,
                                          "column": 37,
                                          "index": 3524
                                        },
                                        "end": {
                                          "line": 68,
                                          "column": 79,
                                          "index": 3566
                                        }
                                      },
                                      "properties": [
                                        {
                                          "type": "SpreadElement",
                                          "start": 3526,
                                          "end": 3536,
                                          "loc": {
                                            "start": {
                                              "line": 68,
                                              "column": 39,
                                              "index": 3526
                                            },
                                            "end": {
                                              "line": 68,
                                              "column": 49,
                                              "index": 3536
                                            }
                                          },
                                          "argument": {
                                            "type": "Identifier",
                                            "start": 3529,
                                            "end": 3536,
                                            "loc": {
                                              "start": {
                                                "line": 68,
                                                "column": 42,
                                                "index": 3529
                                              },
                                              "end": {
                                                "line": 68,
                                                "column": 49,
                                                "index": 3536
                                              },
                                              "identifierName": "options"
                                            },
                                            "name": "options"
                                          }
                                        },
                                        {
                                          "type": "ObjectProperty",
                                          "start": 3538,
                                          "end": 3551,
                                          "loc": {
                                            "start": {
                                              "line": 68,
                                              "column": 51,
                                              "index": 3538
                                            },
                                            "end": {
                                              "line": 68,
                                              "column": 64,
                                              "index": 3551
                                            }
                                          },
                                          "method": false,
                                          "key": {
                                            "type": "Identifier",
                                            "start": 3538,
                                            "end": 3545,
                                            "loc": {
                                              "start": {
                                                "line": 68,
                                                "column": 51,
                                                "index": 3538
                                              },
                                              "end": {
                                                "line": 68,
                                                "column": 58,
                                                "index": 3545
                                              },
                                              "identifierName": "nocache"
                                            },
                                            "name": "nocache"
                                          },
                                          "computed": false,
                                          "shorthand": false,
                                          "value": {
                                            "type": "BooleanLiteral",
                                            "start": 3547,
                                            "end": 3551,
                                            "loc": {
                                              "start": {
                                                "line": 68,
                                                "column": 60,
                                                "index": 3547
                                              },
                                              "end": {
                                                "line": 68,
                                                "column": 64,
                                                "index": 3551
                                              }
                                            },
                                            "value": true
                                          }
                                        },
                                        {
                                          "type": "ObjectProperty",
                                          "start": 3553,
                                          "end": 3564,
                                          "loc": {
                                            "start": {
                                              "line": 68,
                                              "column": 66,
                                              "index": 3553
                                            },
                                            "end": {
                                              "line": 68,
                                              "column": 77,
                                              "index": 3564
                                            }
                                          },
                                          "method": false,
                                          "key": {
                                            "type": "Identifier",
                                            "start": 3553,
                                            "end": 3564,
                                            "loc": {
                                              "start": {
                                                "line": 68,
                                                "column": 66,
                                                "index": 3553
                                              },
                                              "end": {
                                                "line": 68,
                                                "column": 77,
                                                "index": 3564
                                              },
                                              "identifierName": "transaction"
                                            },
                                            "name": "transaction"
                                          },
                                          "computed": false,
                                          "shorthand": true,
                                          "value": {
                                            "type": "Identifier",
                                            "start": 3553,
                                            "end": 3564,
                                            "loc": {
                                              "start": {
                                                "line": 68,
                                                "column": 66,
                                                "index": 3553
                                              },
                                              "end": {
                                                "line": 68,
                                                "column": 77,
                                                "index": 3564
                                              },
                                              "identifierName": "transaction"
                                            },
                                            "name": "transaction"
                                          },
                                          "extra": {
                                            "shorthand": true
                                          }
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            "leadingComments": [
                              {
                                "type": "CommentLine",
                                "value": " console.log(yellow('adding nocache option to table - '));",
                                "start": 3426,
                                "end": 3486,
                                "loc": {
                                  "start": {
                                    "line": 67,
                                    "column": 4,
                                    "index": 3426
                                  },
                                  "end": {
                                    "line": 67,
                                    "column": 64,
                                    "index": 3486
                                  }
                                }
                              }
                            ]
                          }
                        ],
                        "directives": []
                      }
                    }
                  },
                  "leadingComments": [
                    {
                      "type": "CommentLine",
                      "value": " When the database table() method is called we add the nocache option",
                      "start": 3172,
                      "end": 3243,
                      "loc": {
                        "start": {
                          "line": 63,
                          "column": 2,
                          "index": 3172
                        },
                        "end": {
                          "line": 63,
                          "column": 73,
                          "index": 3243
                        }
                      }
                    },
                    {
                      "type": "CommentLine",
                      "value": " so that it always returns a new table with the database set to the",
                      "start": 3246,
                      "end": 3315,
                      "loc": {
                        "start": {
                          "line": 64,
                          "column": 2,
                          "index": 3246
                        },
                        "end": {
                          "line": 64,
                          "column": 71,
                          "index": 3315
                        }
                      }
                    },
                    {
                      "type": "CommentLine",
                      "value": " proxy wrapper around the database",
                      "start": 3318,
                      "end": 3354,
                      "loc": {
                        "start": {
                          "line": 65,
                          "column": 2,
                          "index": 3318
                        },
                        "end": {
                          "line": 65,
                          "column": 38,
                          "index": 3354
                        }
                      }
                    }
                  ]
                },
                {
                  "type": "ObjectProperty",
                  "start": 3719,
                  "end": 3898,
                  "loc": {
                    "start": {
                      "line": 73,
                      "column": 2,
                      "index": 3719
                    },
                    "end": {
                      "line": 78,
                      "column": 3,
                      "index": 3898
                    }
                  },
                  "method": false,
                  "key": {
                    "type": "Identifier",
                    "start": 3719,
                    "end": 3724,
                    "loc": {
                      "start": {
                        "line": 73,
                        "column": 2,
                        "index": 3719
                      },
                      "end": {
                        "line": 73,
                        "column": 7,
                        "index": 3724
                      },
                      "identifierName": "build"
                    },
                    "name": "build"
                  },
                  "computed": false,
                  "shorthand": false,
                  "value": {
                    "type": "ArrowFunctionExpression",
                    "start": 3726,
                    "end": 3898,
                    "loc": {
                      "start": {
                        "line": 73,
                        "column": 9,
                        "index": 3726
                      },
                      "end": {
                        "line": 78,
                        "column": 3,
                        "index": 3898
                      }
                    },
                    "id": null,
                    "generator": false,
                    "async": false,
                    "params": [
                      {
                        "type": "Identifier",
                        "start": 3727,
                        "end": 3733,
                        "loc": {
                          "start": {
                            "line": 73,
                            "column": 10,
                            "index": 3727
                          },
                          "end": {
                            "line": 73,
                            "column": 16,
                            "index": 3733
                          },
                          "identifierName": "target"
                        },
                        "name": "target"
                      },
                      {
                        "type": "Identifier",
                        "start": 3735,
                        "end": 3736,
                        "loc": {
                          "start": {
                            "line": 73,
                            "column": 18,
                            "index": 3735
                          },
                          "end": {
                            "line": 73,
                            "column": 19,
                            "index": 3736
                          },
                          "identifierName": "_"
                        },
                        "name": "_"
                      },
                      {
                        "type": "Identifier",
                        "start": 3738,
                        "end": 3749,
                        "loc": {
                          "start": {
                            "line": 73,
                            "column": 21,
                            "index": 3738
                          },
                          "end": {
                            "line": 73,
                            "column": 32,
                            "index": 3749
                          },
                          "identifierName": "transaction"
                        },
                        "name": "transaction"
                      }
                    ],
                    "body": {
                      "type": "BlockStatement",
                      "start": 3754,
                      "end": 3898,
                      "loc": {
                        "start": {
                          "line": 73,
                          "column": 37,
                          "index": 3754
                        },
                        "end": {
                          "line": 78,
                          "column": 3,
                          "index": 3898
                        }
                      },
                      "body": [
                        {
                          "type": "ReturnStatement",
                          "start": 3821,
                          "end": 3894,
                          "loc": {
                            "start": {
                              "line": 75,
                              "column": 4,
                              "index": 3821
                            },
                            "end": {
                              "line": 77,
                              "column": 5,
                              "index": 3894
                            }
                          },
                          "argument": {
                            "type": "CallExpression",
                            "start": 3828,
                            "end": 3894,
                            "loc": {
                              "start": {
                                "line": 75,
                                "column": 11,
                                "index": 3828
                              },
                              "end": {
                                "line": 77,
                                "column": 5,
                                "index": 3894
                              }
                            },
                            "callee": {
                              "type": "Identifier",
                              "start": 3828,
                              "end": 3843,
                              "loc": {
                                "start": {
                                  "line": 75,
                                  "column": 11,
                                  "index": 3828
                                },
                                "end": {
                                  "line": 75,
                                  "column": 26,
                                  "index": 3843
                                },
                                "identifierName": "databaseBuilder"
                              },
                              "name": "databaseBuilder"
                            },
                            "arguments": [
                              {
                                "type": "CallExpression",
                                "start": 3851,
                                "end": 3888,
                                "loc": {
                                  "start": {
                                    "line": 76,
                                    "column": 6,
                                    "index": 3851
                                  },
                                  "end": {
                                    "line": 76,
                                    "column": 43,
                                    "index": 3888
                                  }
                                },
                                "callee": {
                                  "type": "Identifier",
                                  "start": 3851,
                                  "end": 3867,
                                  "loc": {
                                    "start": {
                                      "line": 76,
                                      "column": 6,
                                      "index": 3851
                                    },
                                    "end": {
                                      "line": 76,
                                      "column": 22,
                                      "index": 3867
                                    },
                                    "identifierName": "transactionProxy"
                                  },
                                  "name": "transactionProxy"
                                },
                                "arguments": [
                                  {
                                    "type": "Identifier",
                                    "start": 3868,
                                    "end": 3874,
                                    "loc": {
                                      "start": {
                                        "line": 76,
                                        "column": 23,
                                        "index": 3868
                                      },
                                      "end": {
                                        "line": 76,
                                        "column": 29,
                                        "index": 3874
                                      },
                                      "identifierName": "target"
                                    },
                                    "name": "target"
                                  },
                                  {
                                    "type": "Identifier",
                                    "start": 3876,
                                    "end": 3887,
                                    "loc": {
                                      "start": {
                                        "line": 76,
                                        "column": 31,
                                        "index": 3876
                                      },
                                      "end": {
                                        "line": 76,
                                        "column": 42,
                                        "index": 3887
                                      },
                                      "identifierName": "transaction"
                                    },
                                    "name": "transaction"
                                  }
                                ]
                              }
                            ]
                          },
                          "leadingComments": [
                            {
                              "type": "CommentLine",
                              "value": " console.log(yellow('generating new database.build'));",
                              "start": 3760,
                              "end": 3816,
                              "loc": {
                                "start": {
                                  "line": 74,
                                  "column": 4,
                                  "index": 3760
                                },
                                "end": {
                                  "line": 74,
                                  "column": 60,
                                  "index": 3816
                                }
                              }
                            }
                          ]
                        }
                      ],
                      "directives": []
                    }
                  },
                  "leadingComments": [
                    {
                      "type": "CommentLine",
                      "value": " The database.build is pre-defined as a wrapper around the database",
                      "start": 3577,
                      "end": 3646,
                      "loc": {
                        "start": {
                          "line": 71,
                          "column": 2,
                          "index": 3577
                        },
                        "end": {
                          "line": 71,
                          "column": 71,
                          "index": 3646
                        }
                      }
                    },
                    {
                      "type": "CommentLine",
                      "value": " so we need to provide a version that is a wrapper around a proxy",
                      "start": 3649,
                      "end": 3716,
                      "loc": {
                        "start": {
                          "line": 72,
                          "column": 2,
                          "index": 3649
                        },
                        "end": {
                          "line": 72,
                          "column": 69,
                          "index": 3716
                        }
                      }
                    }
                  ]
                },
                {
                  "type": "ObjectProperty",
                  "start": 3903,
                  "end": 3974,
                  "loc": {
                    "start": {
                      "line": 80,
                      "column": 2,
                      "index": 3903
                    },
                    "end": {
                      "line": 81,
                      "column": 30,
                      "index": 3974
                    }
                  },
                  "method": false,
                  "key": {
                    "type": "Identifier",
                    "start": 3903,
                    "end": 3909,
                    "loc": {
                      "start": {
                        "line": 80,
                        "column": 2,
                        "index": 3903
                      },
                      "end": {
                        "line": 80,
                        "column": 8,
                        "index": 3909
                      },
                      "identifierName": "commit"
                    },
                    "name": "commit"
                  },
                  "computed": false,
                  "shorthand": false,
                  "value": {
                    "type": "ArrowFunctionExpression",
                    "start": 3911,
                    "end": 3974,
                    "loc": {
                      "start": {
                        "line": 80,
                        "column": 10,
                        "index": 3911
                      },
                      "end": {
                        "line": 81,
                        "column": 30,
                        "index": 3974
                      }
                    },
                    "id": null,
                    "generator": false,
                    "async": false,
                    "params": [
                      {
                        "type": "Identifier",
                        "start": 3912,
                        "end": 3918,
                        "loc": {
                          "start": {
                            "line": 80,
                            "column": 11,
                            "index": 3912
                          },
                          "end": {
                            "line": 80,
                            "column": 17,
                            "index": 3918
                          },
                          "identifierName": "target"
                        },
                        "name": "target"
                      },
                      {
                        "type": "Identifier",
                        "start": 3920,
                        "end": 3926,
                        "loc": {
                          "start": {
                            "line": 80,
                            "column": 19,
                            "index": 3920
                          },
                          "end": {
                            "line": 80,
                            "column": 25,
                            "index": 3926
                          },
                          "identifierName": "method"
                        },
                        "name": "method"
                      },
                      {
                        "type": "Identifier",
                        "start": 3928,
                        "end": 3939,
                        "loc": {
                          "start": {
                            "line": 80,
                            "column": 27,
                            "index": 3928
                          },
                          "end": {
                            "line": 80,
                            "column": 38,
                            "index": 3939
                          },
                          "identifierName": "transaction"
                        },
                        "name": "transaction"
                      }
                    ],
                    "body": {
                      "type": "ArrowFunctionExpression",
                      "start": 3948,
                      "end": 3974,
                      "loc": {
                        "start": {
                          "line": 81,
                          "column": 4,
                          "index": 3948
                        },
                        "end": {
                          "line": 81,
                          "column": 30,
                          "index": 3974
                        }
                      },
                      "id": null,
                      "generator": false,
                      "async": false,
                      "params": [],
                      "body": {
                        "type": "CallExpression",
                        "start": 3954,
                        "end": 3974,
                        "loc": {
                          "start": {
                            "line": 81,
                            "column": 10,
                            "index": 3954
                          },
                          "end": {
                            "line": 81,
                            "column": 30,
                            "index": 3974
                          }
                        },
                        "callee": {
                          "type": "MemberExpression",
                          "start": 3954,
                          "end": 3972,
                          "loc": {
                            "start": {
                              "line": 81,
                              "column": 10,
                              "index": 3954
                            },
                            "end": {
                              "line": 81,
                              "column": 28,
                              "index": 3972
                            }
                          },
                          "object": {
                            "type": "Identifier",
                            "start": 3954,
                            "end": 3965,
                            "loc": {
                              "start": {
                                "line": 81,
                                "column": 10,
                                "index": 3954
                              },
                              "end": {
                                "line": 81,
                                "column": 21,
                                "index": 3965
                              },
                              "identifierName": "transaction"
                            },
                            "name": "transaction"
                          },
                          "computed": false,
                          "property": {
                            "type": "Identifier",
                            "start": 3966,
                            "end": 3972,
                            "loc": {
                              "start": {
                                "line": 81,
                                "column": 22,
                                "index": 3966
                              },
                              "end": {
                                "line": 81,
                                "column": 28,
                                "index": 3972
                              },
                              "identifierName": "commit"
                            },
                            "name": "commit"
                          }
                        },
                        "arguments": []
                      }
                    }
                  }
                },
                {
                  "type": "ObjectProperty",
                  "start": 3979,
                  "end": 4054,
                  "loc": {
                    "start": {
                      "line": 83,
                      "column": 2,
                      "index": 3979
                    },
                    "end": {
                      "line": 84,
                      "column": 32,
                      "index": 4054
                    }
                  },
                  "method": false,
                  "key": {
                    "type": "Identifier",
                    "start": 3979,
                    "end": 3987,
                    "loc": {
                      "start": {
                        "line": 83,
                        "column": 2,
                        "index": 3979
                      },
                      "end": {
                        "line": 83,
                        "column": 10,
                        "index": 3987
                      },
                      "identifierName": "rollback"
                    },
                    "name": "rollback"
                  },
                  "computed": false,
                  "shorthand": false,
                  "value": {
                    "type": "ArrowFunctionExpression",
                    "start": 3989,
                    "end": 4054,
                    "loc": {
                      "start": {
                        "line": 83,
                        "column": 12,
                        "index": 3989
                      },
                      "end": {
                        "line": 84,
                        "column": 32,
                        "index": 4054
                      }
                    },
                    "id": null,
                    "generator": false,
                    "async": false,
                    "params": [
                      {
                        "type": "Identifier",
                        "start": 3990,
                        "end": 3996,
                        "loc": {
                          "start": {
                            "line": 83,
                            "column": 13,
                            "index": 3990
                          },
                          "end": {
                            "line": 83,
                            "column": 19,
                            "index": 3996
                          },
                          "identifierName": "target"
                        },
                        "name": "target"
                      },
                      {
                        "type": "Identifier",
                        "start": 3998,
                        "end": 4004,
                        "loc": {
                          "start": {
                            "line": 83,
                            "column": 21,
                            "index": 3998
                          },
                          "end": {
                            "line": 83,
                            "column": 27,
                            "index": 4004
                          },
                          "identifierName": "method"
                        },
                        "name": "method"
                      },
                      {
                        "type": "Identifier",
                        "start": 4006,
                        "end": 4017,
                        "loc": {
                          "start": {
                            "line": 83,
                            "column": 29,
                            "index": 4006
                          },
                          "end": {
                            "line": 83,
                            "column": 40,
                            "index": 4017
                          },
                          "identifierName": "transaction"
                        },
                        "name": "transaction"
                      }
                    ],
                    "body": {
                      "type": "ArrowFunctionExpression",
                      "start": 4026,
                      "end": 4054,
                      "loc": {
                        "start": {
                          "line": 84,
                          "column": 4,
                          "index": 4026
                        },
                        "end": {
                          "line": 84,
                          "column": 32,
                          "index": 4054
                        }
                      },
                      "id": null,
                      "generator": false,
                      "async": false,
                      "params": [],
                      "body": {
                        "type": "CallExpression",
                        "start": 4032,
                        "end": 4054,
                        "loc": {
                          "start": {
                            "line": 84,
                            "column": 10,
                            "index": 4032
                          },
                          "end": {
                            "line": 84,
                            "column": 32,
                            "index": 4054
                          }
                        },
                        "callee": {
                          "type": "MemberExpression",
                          "start": 4032,
                          "end": 4052,
                          "loc": {
                            "start": {
                              "line": 84,
                              "column": 10,
                              "index": 4032
                            },
                            "end": {
                              "line": 84,
                              "column": 30,
                              "index": 4052
                            }
                          },
                          "object": {
                            "type": "Identifier",
                            "start": 4032,
                            "end": 4043,
                            "loc": {
                              "start": {
                                "line": 84,
                                "column": 10,
                                "index": 4032
                              },
                              "end": {
                                "line": 84,
                                "column": 21,
                                "index": 4043
                              },
                              "identifierName": "transaction"
                            },
                            "name": "transaction"
                          },
                          "computed": false,
                          "property": {
                            "type": "Identifier",
                            "start": 4044,
                            "end": 4052,
                            "loc": {
                              "start": {
                                "line": 84,
                                "column": 22,
                                "index": 4044
                              },
                              "end": {
                                "line": 84,
                                "column": 30,
                                "index": 4052
                              },
                              "identifierName": "rollback"
                            },
                            "name": "rollback"
                          }
                        },
                        "arguments": []
                      }
                    }
                  }
                },
                {
                  "type": "ObjectProperty",
                  "start": 4059,
                  "end": 4078,
                  "loc": {
                    "start": {
                      "line": 86,
                      "column": 2,
                      "index": 4059
                    },
                    "end": {
                      "line": 86,
                      "column": 21,
                      "index": 4078
                    }
                  },
                  "method": false,
                  "key": {
                    "type": "Identifier",
                    "start": 4059,
                    "end": 4066,
                    "loc": {
                      "start": {
                        "line": 86,
                        "column": 2,
                        "index": 4059
                      },
                      "end": {
                        "line": 86,
                        "column": 9,
                        "index": 4066
                      },
                      "identifierName": "isProxy"
                    },
                    "name": "isProxy"
                  },
                  "computed": false,
                  "shorthand": false,
                  "value": {
                    "type": "ArrowFunctionExpression",
                    "start": 4068,
                    "end": 4078,
                    "loc": {
                      "start": {
                        "line": 86,
                        "column": 11,
                        "index": 4068
                      },
                      "end": {
                        "line": 86,
                        "column": 21,
                        "index": 4078
                      }
                    },
                    "id": null,
                    "generator": false,
                    "async": false,
                    "params": [],
                    "body": {
                      "type": "BooleanLiteral",
                      "start": 4074,
                      "end": 4078,
                      "loc": {
                        "start": {
                          "line": 86,
                          "column": 17,
                          "index": 4074
                        },
                        "end": {
                          "line": 86,
                          "column": 21,
                          "index": 4078
                        }
                      },
                      "value": true
                    }
                  }
                }
              ]
            }
          }
        ],
        "kind": "const",
        "leadingComments": [
          {
            "type": "CommentLine",
            "value": " import { yellow } from \"../Utils/Color.js\";",
            "start": 2761,
            "end": 2807,
            "loc": {
              "start": {
                "line": 53,
                "column": 0,
                "index": 2761
              },
              "end": {
                "line": 53,
                "column": 46,
                "index": 2807
              }
            }
          }
        ]
      },
      {
        "type": "ExportNamedDeclaration",
        "start": 4082,
        "end": 4416,
        "loc": {
          "start": {
            "line": 89,
            "column": 0,
            "index": 4082
          },
          "end": {
            "line": 102,
            "column": 3,
            "index": 4416
          }
        },
        "specifiers": [],
        "source": null,
        "declaration": {
          "type": "VariableDeclaration",
          "start": 4089,
          "end": 4416,
          "loc": {
            "start": {
              "line": 89,
              "column": 7,
              "index": 4089
            },
            "end": {
              "line": 102,
              "column": 3,
              "index": 4416
            }
          },
          "declarations": [
            {
              "type": "VariableDeclarator",
              "start": 4095,
              "end": 4416,
              "loc": {
                "start": {
                  "line": 89,
                  "column": 13,
                  "index": 4095
                },
                "end": {
                  "line": 102,
                  "column": 3,
                  "index": 4416
                }
              },
              "id": {
                "type": "Identifier",
                "start": 4095,
                "end": 4111,
                "loc": {
                  "start": {
                    "line": 89,
                    "column": 13,
                    "index": 4095
                  },
                  "end": {
                    "line": 89,
                    "column": 29,
                    "index": 4111
                  },
                  "identifierName": "transactionProxy"
                },
                "name": "transactionProxy"
              },
              "init": {
                "type": "ArrowFunctionExpression",
                "start": 4114,
                "end": 4416,
                "loc": {
                  "start": {
                    "line": 89,
                    "column": 32,
                    "index": 4114
                  },
                  "end": {
                    "line": 102,
                    "column": 3,
                    "index": 4416
                  }
                },
                "id": {
                  "type": "Identifier",
                  "start": 4095,
                  "end": 4111,
                  "loc": {
                    "start": {
                      "line": 89,
                      "column": 13,
                      "index": 4095
                    },
                    "end": {
                      "line": 89,
                      "column": 29,
                      "index": 4111
                    },
                    "identifierName": "transactionProxy"
                  },
                  "name": "transactionProxy"
                },
                "generator": false,
                "async": false,
                "params": [
                  {
                    "type": "Identifier",
                    "start": 4115,
                    "end": 4123,
                    "loc": {
                      "start": {
                        "line": 89,
                        "column": 33,
                        "index": 4115
                      },
                      "end": {
                        "line": 89,
                        "column": 41,
                        "index": 4123
                      },
                      "identifierName": "database"
                    },
                    "name": "database"
                  },
                  {
                    "type": "Identifier",
                    "start": 4125,
                    "end": 4136,
                    "loc": {
                      "start": {
                        "line": 89,
                        "column": 43,
                        "index": 4125
                      },
                      "end": {
                        "line": 89,
                        "column": 54,
                        "index": 4136
                      },
                      "identifierName": "transaction"
                    },
                    "name": "transaction"
                  }
                ],
                "body": {
                  "type": "NewExpression",
                  "start": 4143,
                  "end": 4416,
                  "loc": {
                    "start": {
                      "line": 90,
                      "column": 2,
                      "index": 4143
                    },
                    "end": {
                      "line": 102,
                      "column": 3,
                      "index": 4416
                    }
                  },
                  "callee": {
                    "type": "Identifier",
                    "start": 4147,
                    "end": 4152,
                    "loc": {
                      "start": {
                        "line": 90,
                        "column": 6,
                        "index": 4147
                      },
                      "end": {
                        "line": 90,
                        "column": 11,
                        "index": 4152
                      },
                      "identifierName": "Proxy"
                    },
                    "name": "Proxy"
                  },
                  "arguments": [
                    {
                      "type": "Identifier",
                      "start": 4158,
                      "end": 4166,
                      "loc": {
                        "start": {
                          "line": 91,
                          "column": 4,
                          "index": 4158
                        },
                        "end": {
                          "line": 91,
                          "column": 12,
                          "index": 4166
                        },
                        "identifierName": "database"
                      },
                      "name": "database"
                    },
                    {
                      "type": "ObjectExpression",
                      "start": 4172,
                      "end": 4412,
                      "loc": {
                        "start": {
                          "line": 92,
                          "column": 4,
                          "index": 4172
                        },
                        "end": {
                          "line": 101,
                          "column": 5,
                          "index": 4412
                        }
                      },
                      "properties": [
                        {
                          "type": "ObjectMethod",
                          "start": 4180,
                          "end": 4406,
                          "loc": {
                            "start": {
                              "line": 93,
                              "column": 6,
                              "index": 4180
                            },
                            "end": {
                              "line": 100,
                              "column": 7,
                              "index": 4406
                            }
                          },
                          "method": true,
                          "key": {
                            "type": "Identifier",
                            "start": 4180,
                            "end": 4183,
                            "loc": {
                              "start": {
                                "line": 93,
                                "column": 6,
                                "index": 4180
                              },
                              "end": {
                                "line": 93,
                                "column": 9,
                                "index": 4183
                              },
                              "identifierName": "get"
                            },
                            "name": "get"
                          },
                          "computed": false,
                          "kind": "method",
                          "id": null,
                          "generator": false,
                          "async": false,
                          "params": [
                            {
                              "type": "Identifier",
                              "start": 4184,
                              "end": 4190,
                              "loc": {
                                "start": {
                                  "line": 93,
                                  "column": 10,
                                  "index": 4184
                                },
                                "end": {
                                  "line": 93,
                                  "column": 16,
                                  "index": 4190
                                },
                                "identifierName": "target"
                              },
                              "name": "target"
                            },
                            {
                              "type": "Identifier",
                              "start": 4192,
                              "end": 4196,
                              "loc": {
                                "start": {
                                  "line": 93,
                                  "column": 18,
                                  "index": 4192
                                },
                                "end": {
                                  "line": 93,
                                  "column": 22,
                                  "index": 4196
                                },
                                "identifierName": "prop"
                              },
                              "name": "prop"
                            }
                          ],
                          "body": {
                            "type": "BlockStatement",
                            "start": 4198,
                            "end": 4406,
                            "loc": {
                              "start": {
                                "line": 93,
                                "column": 24,
                                "index": 4198
                              },
                              "end": {
                                "line": 100,
                                "column": 7,
                                "index": 4406
                              }
                            },
                            "body": [
                              {
                                "type": "VariableDeclaration",
                                "start": 4208,
                                "end": 4250,
                                "loc": {
                                  "start": {
                                    "line": 94,
                                    "column": 8,
                                    "index": 4208
                                  },
                                  "end": {
                                    "line": 94,
                                    "column": 50,
                                    "index": 4250
                                  }
                                },
                                "declarations": [
                                  {
                                    "type": "VariableDeclarator",
                                    "start": 4214,
                                    "end": 4249,
                                    "loc": {
                                      "start": {
                                        "line": 94,
                                        "column": 14,
                                        "index": 4214
                                      },
                                      "end": {
                                        "line": 94,
                                        "column": 49,
                                        "index": 4249
                                      }
                                    },
                                    "id": {
                                      "type": "Identifier",
                                      "start": 4214,
                                      "end": 4219,
                                      "loc": {
                                        "start": {
                                          "line": 94,
                                          "column": 14,
                                          "index": 4214
                                        },
                                        "end": {
                                          "line": 94,
                                          "column": 19,
                                          "index": 4219
                                        },
                                        "identifierName": "value"
                                      },
                                      "name": "value"
                                    },
                                    "init": {
                                      "type": "CallExpression",
                                      "start": 4224,
                                      "end": 4249,
                                      "loc": {
                                        "start": {
                                          "line": 94,
                                          "column": 24,
                                          "index": 4224
                                        },
                                        "end": {
                                          "line": 94,
                                          "column": 49,
                                          "index": 4249
                                        }
                                      },
                                      "callee": {
                                        "type": "MemberExpression",
                                        "start": 4224,
                                        "end": 4235,
                                        "loc": {
                                          "start": {
                                            "line": 94,
                                            "column": 24,
                                            "index": 4224
                                          },
                                          "end": {
                                            "line": 94,
                                            "column": 35,
                                            "index": 4235
                                          }
                                        },
                                        "object": {
                                          "type": "Identifier",
                                          "start": 4224,
                                          "end": 4231,
                                          "loc": {
                                            "start": {
                                              "line": 94,
                                              "column": 24,
                                              "index": 4224
                                            },
                                            "end": {
                                              "line": 94,
                                              "column": 31,
                                              "index": 4231
                                            },
                                            "identifierName": "Reflect"
                                          },
                                          "name": "Reflect"
                                        },
                                        "computed": false,
                                        "property": {
                                          "type": "Identifier",
                                          "start": 4232,
                                          "end": 4235,
                                          "loc": {
                                            "start": {
                                              "line": 94,
                                              "column": 32,
                                              "index": 4232
                                            },
                                            "end": {
                                              "line": 94,
                                              "column": 35,
                                              "index": 4235
                                            },
                                            "identifierName": "get"
                                          },
                                          "name": "get"
                                        }
                                      },
                                      "arguments": [
                                        {
                                          "type": "Identifier",
                                          "start": 4236,
                                          "end": 4242,
                                          "loc": {
                                            "start": {
                                              "line": 94,
                                              "column": 36,
                                              "index": 4236
                                            },
                                            "end": {
                                              "line": 94,
                                              "column": 42,
                                              "index": 4242
                                            },
                                            "identifierName": "target"
                                          },
                                          "name": "target"
                                        },
                                        {
                                          "type": "Identifier",
                                          "start": 4244,
                                          "end": 4248,
                                          "loc": {
                                            "start": {
                                              "line": 94,
                                              "column": 44,
                                              "index": 4244
                                            },
                                            "end": {
                                              "line": 94,
                                              "column": 48,
                                              "index": 4248
                                            },
                                            "identifierName": "prop"
                                          },
                                          "name": "prop"
                                        }
                                      ]
                                    }
                                  }
                                ],
                                "kind": "const"
                              },
                              {
                                "type": "VariableDeclaration",
                                "start": 4259,
                                "end": 4290,
                                "loc": {
                                  "start": {
                                    "line": 95,
                                    "column": 8,
                                    "index": 4259
                                  },
                                  "end": {
                                    "line": 95,
                                    "column": 39,
                                    "index": 4290
                                  }
                                },
                                "declarations": [
                                  {
                                    "type": "VariableDeclarator",
                                    "start": 4265,
                                    "end": 4289,
                                    "loc": {
                                      "start": {
                                        "line": 95,
                                        "column": 14,
                                        "index": 4265
                                      },
                                      "end": {
                                        "line": 95,
                                        "column": 38,
                                        "index": 4289
                                      }
                                    },
                                    "id": {
                                      "type": "Identifier",
                                      "start": 4265,
                                      "end": 4272,
                                      "loc": {
                                        "start": {
                                          "line": 95,
                                          "column": 14,
                                          "index": 4265
                                        },
                                        "end": {
                                          "line": 95,
                                          "column": 21,
                                          "index": 4272
                                        },
                                        "identifierName": "handler"
                                      },
                                      "name": "handler"
                                    },
                                    "init": {
                                      "type": "MemberExpression",
                                      "start": 4275,
                                      "end": 4289,
                                      "loc": {
                                        "start": {
                                          "line": 95,
                                          "column": 24,
                                          "index": 4275
                                        },
                                        "end": {
                                          "line": 95,
                                          "column": 38,
                                          "index": 4289
                                        }
                                      },
                                      "object": {
                                        "type": "Identifier",
                                        "start": 4275,
                                        "end": 4283,
                                        "loc": {
                                          "start": {
                                            "line": 95,
                                            "column": 24,
                                            "index": 4275
                                          },
                                          "end": {
                                            "line": 95,
                                            "column": 32,
                                            "index": 4283
                                          },
                                          "identifierName": "handlers"
                                        },
                                        "name": "handlers"
                                      },
                                      "computed": true,
                                      "property": {
                                        "type": "Identifier",
                                        "start": 4284,
                                        "end": 4288,
                                        "loc": {
                                          "start": {
                                            "line": 95,
                                            "column": 33,
                                            "index": 4284
                                          },
                                          "end": {
                                            "line": 95,
                                            "column": 37,
                                            "index": 4288
                                          },
                                          "identifierName": "prop"
                                        },
                                        "name": "prop"
                                      }
                                    }
                                  }
                                ],
                                "kind": "const"
                              },
                              {
                                "type": "IfStatement",
                                "start": 4299,
                                "end": 4376,
                                "loc": {
                                  "start": {
                                    "line": 96,
                                    "column": 8,
                                    "index": 4299
                                  },
                                  "end": {
                                    "line": 98,
                                    "column": 9,
                                    "index": 4376
                                  }
                                },
                                "test": {
                                  "type": "Identifier",
                                  "start": 4303,
                                  "end": 4310,
                                  "loc": {
                                    "start": {
                                      "line": 96,
                                      "column": 12,
                                      "index": 4303
                                    },
                                    "end": {
                                      "line": 96,
                                      "column": 19,
                                      "index": 4310
                                    },
                                    "identifierName": "handler"
                                  },
                                  "name": "handler"
                                },
                                "consequent": {
                                  "type": "BlockStatement",
                                  "start": 4312,
                                  "end": 4376,
                                  "loc": {
                                    "start": {
                                      "line": 96,
                                      "column": 21,
                                      "index": 4312
                                    },
                                    "end": {
                                      "line": 98,
                                      "column": 9,
                                      "index": 4376
                                    }
                                  },
                                  "body": [
                                    {
                                      "type": "ReturnStatement",
                                      "start": 4324,
                                      "end": 4366,
                                      "loc": {
                                        "start": {
                                          "line": 97,
                                          "column": 10,
                                          "index": 4324
                                        },
                                        "end": {
                                          "line": 97,
                                          "column": 52,
                                          "index": 4366
                                        }
                                      },
                                      "argument": {
                                        "type": "CallExpression",
                                        "start": 4331,
                                        "end": 4366,
                                        "loc": {
                                          "start": {
                                            "line": 97,
                                            "column": 17,
                                            "index": 4331
                                          },
                                          "end": {
                                            "line": 97,
                                            "column": 52,
                                            "index": 4366
                                          }
                                        },
                                        "callee": {
                                          "type": "Identifier",
                                          "start": 4331,
                                          "end": 4338,
                                          "loc": {
                                            "start": {
                                              "line": 97,
                                              "column": 17,
                                              "index": 4331
                                            },
                                            "end": {
                                              "line": 97,
                                              "column": 24,
                                              "index": 4338
                                            },
                                            "identifierName": "handler"
                                          },
                                          "name": "handler"
                                        },
                                        "arguments": [
                                          {
                                            "type": "Identifier",
                                            "start": 4339,
                                            "end": 4345,
                                            "loc": {
                                              "start": {
                                                "line": 97,
                                                "column": 25,
                                                "index": 4339
                                              },
                                              "end": {
                                                "line": 97,
                                                "column": 31,
                                                "index": 4345
                                              },
                                              "identifierName": "target"
                                            },
                                            "name": "target"
                                          },
                                          {
                                            "type": "Identifier",
                                            "start": 4347,
                                            "end": 4352,
                                            "loc": {
                                              "start": {
                                                "line": 97,
                                                "column": 33,
                                                "index": 4347
                                              },
                                              "end": {
                                                "line": 97,
                                                "column": 38,
                                                "index": 4352
                                              },
                                              "identifierName": "value"
                                            },
                                            "name": "value"
                                          },
                                          {
                                            "type": "Identifier",
                                            "start": 4354,
                                            "end": 4365,
                                            "loc": {
                                              "start": {
                                                "line": 97,
                                                "column": 40,
                                                "index": 4354
                                              },
                                              "end": {
                                                "line": 97,
                                                "column": 51,
                                                "index": 4365
                                              },
                                              "identifierName": "transaction"
                                            },
                                            "name": "transaction"
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "directives": []
                                },
                                "alternate": null
                              },
                              {
                                "type": "ReturnStatement",
                                "start": 4385,
                                "end": 4398,
                                "loc": {
                                  "start": {
                                    "line": 99,
                                    "column": 8,
                                    "index": 4385
                                  },
                                  "end": {
                                    "line": 99,
                                    "column": 21,
                                    "index": 4398
                                  }
                                },
                                "argument": {
                                  "type": "Identifier",
                                  "start": 4392,
                                  "end": 4397,
                                  "loc": {
                                    "start": {
                                      "line": 99,
                                      "column": 15,
                                      "index": 4392
                                    },
                                    "end": {
                                      "line": 99,
                                      "column": 20,
                                      "index": 4397
                                    },
                                    "identifierName": "value"
                                  },
                                  "name": "value"
                                }
                              }
                            ],
                            "directives": []
                          }
                        }
                      ]
                    }
                  ]
                }
              }
            }
          ],
          "kind": "const",
          "leadingComments": [],
          "trailingComments": []
        }
      },
      {
        "type": "ExportDefaultDeclaration",
        "start": 4418,
        "end": 4449,
        "loc": {
          "start": {
            "line": 104,
            "column": 0,
            "index": 4418
          },
          "end": {
            "line": 104,
            "column": 31,
            "index": 4449
          }
        },
        "declaration": {
          "type": "Identifier",
          "start": 4433,
          "end": 4449,
          "loc": {
            "start": {
              "line": 104,
              "column": 15,
              "index": 4433
            },
            "end": {
              "line": 104,
              "column": 31,
              "index": 4449
            },
            "identifierName": "transactionProxy"
          },
          "name": "transactionProxy",
          "leadingComments": [],
          "trailingComments": []
        }
      }
    ],
    "directives": []
  },
  "comments": [
    {
      "type": "CommentBlock",
      "value": "\n  This is a proxy around the database for processing transactions.\n  It's an elegant hack, or an ugly hack, depending on how you look at\n  it.  But either way, it's a hack.\n\n  All requests in a transaction must be run using the same database\n  connection.  This is a problem because we use a connection pool.\n  When a query is run the engine takes a connection from the pool,\n  runs the query and then releases the connection back to the pool.\n  This proxy exists to convince the engine to do something different.\n\n  The database transaction() method creates a Transaction object and\n  then calls its run() method.  The run() method acquires a database\n  connection from the pool and then calls the user code provided to\n  it.  It passes this proxy wrapper around the database along with\n  commit and rollback handlers.  When the run() method is complete\n  the connection is released back to the pool.\n\n  The other part of the puzzle is making sure that the database engine\n  uses the transaction's database connection instead of acquiring a new\n  one. All queries are created as Query objects via the database\n  buildQuery() method.  The proxy catches calls to that method and adds\n  the transaction reference to the configuration options. The Query\n  module then forwards the transaction reference to the engine.execute()\n  method which will then use the transaction's connection instead of\n  acquiring one from the connection pool.\n\n  We also need to catch any calls to the table() method and add in the\n  nocache option.  This ensures that a NEW table object is created with\n  a database reference that is the proxy wrapper for the database rather\n  than the database itself.  This ensures that any database queries that\n  are run by the table object inside a transaction are also run the\n  same way using the transaction's connection.  Table objects are cached\n  so if we didn't do this then there's the chance we'd get a cached table\n  which had a reference to the unwrapped database.\n\n  We also need to intercept any access to database.build which contains\n  a \"root node\" for using the query builder.  The select(), insert(),\n  update() and delete() methods all use this, and end users can also use\n  it to construct new queries.  Instead of returning the cached\n  database.build (which contains a reference to the database), we create\n  a new builder object which contains a reference to the database proxy\n  wrapper.\n\n  (DONE), model and waiter.\n  TODO: I've got a nasty suspicion that we could have problems with named\n  queries or fragments that are built using the query builder as they\n  are all rooted on a Builder/Database node that contains the database\n  reference.  Need to check this.\n",
      "start": 0,
      "end": 2710,
      "loc": {
        "start": {
          "line": 1,
          "column": 0,
          "index": 0
        },
        "end": {
          "line": 50,
          "column": 2,
          "index": 2710
        }
      }
    },
    {
      "type": "CommentLine",
      "value": " import { yellow } from \"../Utils/Color.js\";",
      "start": 2761,
      "end": 2807,
      "loc": {
        "start": {
          "line": 53,
          "column": 0,
          "index": 2761
        },
        "end": {
          "line": 53,
          "column": 46,
          "index": 2807
        }
      }
    },
    {
      "type": "CommentLine",
      "value": " When the database buildQuery() method is called we add the",
      "start": 2830,
      "end": 2891,
      "loc": {
        "start": {
          "line": 56,
          "column": 2,
          "index": 2830
        },
        "end": {
          "line": 56,
          "column": 63,
          "index": 2891
        }
      }
    },
    {
      "type": "CommentLine",
      "value": " transaction reference into the configuration options",
      "start": 2894,
      "end": 2949,
      "loc": {
        "start": {
          "line": 57,
          "column": 2,
          "index": 2894
        },
        "end": {
          "line": 57,
          "column": 57,
          "index": 2949
        }
      }
    },
    {
      "type": "CommentLine",
      "value": " console.log(yellow('adding transaction to buildQuery() config'));",
      "start": 3027,
      "end": 3095,
      "loc": {
        "start": {
          "line": 59,
          "column": 4,
          "index": 3027
        },
        "end": {
          "line": 59,
          "column": 72,
          "index": 3095
        }
      }
    },
    {
      "type": "CommentLine",
      "value": " When the database table() method is called we add the nocache option",
      "start": 3172,
      "end": 3243,
      "loc": {
        "start": {
          "line": 63,
          "column": 2,
          "index": 3172
        },
        "end": {
          "line": 63,
          "column": 73,
          "index": 3243
        }
      }
    },
    {
      "type": "CommentLine",
      "value": " so that it always returns a new table with the database set to the",
      "start": 3246,
      "end": 3315,
      "loc": {
        "start": {
          "line": 64,
          "column": 2,
          "index": 3246
        },
        "end": {
          "line": 64,
          "column": 71,
          "index": 3315
        }
      }
    },
    {
      "type": "CommentLine",
      "value": " proxy wrapper around the database",
      "start": 3318,
      "end": 3354,
      "loc": {
        "start": {
          "line": 65,
          "column": 2,
          "index": 3318
        },
        "end": {
          "line": 65,
          "column": 38,
          "index": 3354
        }
      }
    },
    {
      "type": "CommentLine",
      "value": " console.log(yellow('adding nocache option to table - '));",
      "start": 3426,
      "end": 3486,
      "loc": {
        "start": {
          "line": 67,
          "column": 4,
          "index": 3426
        },
        "end": {
          "line": 67,
          "column": 64,
          "index": 3486
        }
      }
    },
    {
      "type": "CommentLine",
      "value": " The database.build is pre-defined as a wrapper around the database",
      "start": 3577,
      "end": 3646,
      "loc": {
        "start": {
          "line": 71,
          "column": 2,
          "index": 3577
        },
        "end": {
          "line": 71,
          "column": 71,
          "index": 3646
        }
      }
    },
    {
      "type": "CommentLine",
      "value": " so we need to provide a version that is a wrapper around a proxy",
      "start": 3649,
      "end": 3716,
      "loc": {
        "start": {
          "line": 72,
          "column": 2,
          "index": 3649
        },
        "end": {
          "line": 72,
          "column": 69,
          "index": 3716
        }
      }
    },
    {
      "type": "CommentLine",
      "value": " console.log(yellow('generating new database.build'));",
      "start": 3760,
      "end": 3816,
      "loc": {
        "start": {
          "line": 74,
          "column": 4,
          "index": 3760
        },
        "end": {
          "line": 74,
          "column": 60,
          "index": 3816
        }
      }
    }
  ]
}